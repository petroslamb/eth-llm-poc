id,category,enforcement_type,statement,locations,code_flow,obligation_gap,code_gap
EIP1559-OBL-001,transaction_type,tx_validation,A new EIP-2718 transaction type with type 2 is introduced at FORK_BLOCK_NUMBER,"[forks/london/__init__.py:L48, forks/london/transactions.py:L210-L282, forks/london/transactions.py:L303-L304, forks/london/transactions.py:L320-L321]",Fork initialization defines new transaction type at FORK_BLOCK_NUMBER → London fork module imports new transaction type → Transaction type 2 is registered in transaction factory,,
EIP1559-OBL-002,transaction_format,tx_validation,"Transaction type 2 payload is rlp([chain_id, nonce, max_priority_fee_per_gas, max_fee_per_gas, gas_limit, destination, amount, data, access_list, signature_y_parity, signature_r, signature_s])","[forks/london/transactions.py:L210-L282, forks/london/transactions.py:L533-L557]","Transaction parser receives type 2 transaction → Decodes RLP payload [chain_id, nonce, max_priority_fee_per_gas, max_fee_per_gas, gas_limit, destination, amount, data, access_list, signature_y_parity, signature_r, signature_s] → Validates field presence and types → Returns structured transaction object",,
EIP1559-OBL-003,transaction_signature,tx_validation,"Signature for type 2 transaction is secp256k1 signature over keccak256(0x02 || rlp([chain_id, nonce, max_priority_fee_per_gas, max_fee_per_gas, gas_limit, destination, amount, data, access_list]))","[forks/london/transactions.py:L447-L452, forks/london/transactions.py:L533-L557]","Transaction signature validation extracts type 2 transaction fields → Computes signing hash as keccak256(0x02 || rlp([chain_id, nonce, max_priority_fee_per_gas, max_fee_per_gas, gas_limit, destination, amount, data, access_list])) → Uses secp256k1 to recover signer public key → Validates signature matches transaction data",,
EIP1559-OBL-004,transaction_intrinsic_cost,tx_validation,Intrinsic cost of type 2 transaction is 21000 + 16 * non-zero calldata bytes + 4 * zero calldata bytes + 1900 * access list storage key count + 2400 * access list address count,"[forks/london/transactions.py:L26-L55, forks/london/transactions.py:L359-L402]","Transaction intrinsic gas calculation: base cost 21000 + calldata gas (16 per non-zero byte, 4 per zero byte) + access list cost (1900 per storage key, 2400 per address) → Total is compared against tx gas_limit → Must not exceed gas_limit",,
EIP1559-OBL-005,transaction_receipt,block_validation,"Transaction receipt payload is rlp([status, cumulative_transaction_gas_used, logs_bloom, logs])","[forks/london/blocks.py:L262-L291, forks/london/blocks.py:L294-L308, forks/london/blocks.py:L311-L326]","Block execution completes → Collects transaction receipt: status (1 if successful, 0 if reverted), cumulative gas used, logs bloom, and all logs → Encodes as RLP([status, cumulative_tx_gas_used, logs_bloom, logs]) → Stores in block receipts",,
EIP1559-OBL-006,base_fee_adjustment,block_validation,Base fee per gas moves up or down each block according to a formula based on gas used in parent block and gas target of parent block,[forks/london/fork.py:L222-L282],Next block generation accesses parent block gas used and gas target → Calculates base fee adjustment delta → If gas used > target: increase base fee (minimum +1) → If gas used < target: decrease base fee → If gas used == target: base fee unchanged → New block gets adjusted base fee,,
EIP1559-OBL-007,base_fee_adjustment,block_validation,Base fee per gas increases when parent block gas used exceeds parent gas target,[forks/london/fork.py:L254-L266],"Base fee calculation reads parent gas used and parent gas target → Compares gas used > gas target → Calculates delta = (gas_used - gas_target) → Computes increase = max(parent_base_fee * delta / gas_target / 8, 1) → Adds to parent base fee",,
EIP1559-OBL-008,base_fee_adjustment,block_validation,Base fee per gas decreases when parent block gas used is below parent gas target,[forks/london/fork.py:L268-L280],Base fee calculation reads parent gas used and parent gas target → Compares gas used < gas target → Calculates delta = (gas_target - gas_used) → Computes decrease = parent_base_fee * delta / gas_target / 8 → Subtracts from parent base fee (floor to 0),,
EIP1559-OBL-009,gas_target,block_validation,Gas target is block gas limit divided by elasticity multiplier (2x),"[forks/london/fork.py:L68-L69, forks/london/fork.py:L248]",Block creation sets gas_target = parent block gas_limit / 2 (elasticity multiplier is 2) → Gas target defines the equilibrium point for base fee adjustments,,
EIP1559-OBL-010,base_fee,execution_semantics,"Base fee per gas is always burned (destroyed by protocol, not given to miners)",[forks/london/fork.py:L809-L831],Transaction execution completes → Base fee amount is calculated as gas_used * base_fee_per_gas → Amount is burned (removed from total supply) → Not transferred to miner or any account → Protocol destroys the value,,
EIP1559-OBL-011,fees,tx_validation,Transactions specify max_priority_fee_per_gas (priority fee to incentivize miners),[forks/london/transactions.py:L230-L233],Type 2 transaction payload includes max_priority_fee_per_gas field → Signer sets this value when constructing transaction → Represents the tip paid to miner/validator above base fee → Validated during transaction deserialization,,
EIP1559-OBL-012,fees,tx_validation,Transactions specify max_fee_per_gas (maximum total fee covering priority fee and base fee),[forks/london/transactions.py:L235-L239],Type 2 transaction payload includes max_fee_per_gas field → Signer sets this value as absolute maximum fee per gas → Represents total fee including both base fee and priority fee → Validated during transaction deserialization and execution,,
EIP1559-OBL-013,fee_payment,execution_semantics,Signer pays base fee per gas of the block their transaction is included in,[forks/london/fork.py:L767-L777],Transaction execution → Base fee is determined from block header → Amount deducted = gas_used * base_fee_per_gas from signer's account → Base fee is immediately burned (removed from total supply),,
EIP1559-OBL-014,fee_payment,execution_semantics,Signer pays priority fee per gas as specified in transaction (if combined fees do not exceed max_fee_per_gas),"[forks/london/fork.py:L497-L501, forks/london/fork.py:L767-L777]","Transaction execution → Priority fee is capped by max_priority_fee_per_gas in transaction → Effective priority fee = min(max_priority_fee_per_gas, max_fee_per_gas - actual_base_fee_per_gas) → Amount deducted from signer = effective_priority_fee * gas_used → Transferred to miner/validator",,
EIP1559-OBL-015,priority_fee,execution_semantics,"Priority fee per gas is capped at min(max_priority_fee_per_gas, max_fee_per_gas - base_fee_per_gas)",[forks/london/fork.py:L497-L500],"Block execution reads transaction max_priority_fee_per_gas and max_fee_per_gas → Gets actual_base_fee_per_gas from block header → Calculates actual_priority_fee = min(max_priority_fee_per_gas, max_fee_per_gas - actual_base_fee_per_gas) → Uses actual_priority_fee for miner reward and fee accounting",,
EIP1559-OBL-016,effective_gas_price,execution_semantics,Effective gas price returned by GASPRICE opcode is priority_fee_per_gas + base_fee_per_gas,[forks/london/vm/instructions/environment.py:L304-L324],GASPRICE opcode (0x3a) execution → Retrieves actual priority fee from transaction and base fee from block → Computes effective_gas_price = priority_fee_per_gas + base_fee_per_gas → Returns value to EVM execution context,,
EIP1559-OBL-017,miner_reward,execution_semantics,Miner receives only the priority fee (not the base fee which is burned),[forks/london/fork.py:L810-L822],Block execution completes → Miner reward calculated from transaction priority fees (tips) → No portion of base fee is awarded to miner → Base fee is burned separately → Miner receives only: sum of (priority_fee_per_gas * gas_used) for all transactions in block,,
EIP1559-OBL-018,block_validation,block_validation,Block gas used must not exceed block gas limit,[forks/london/fork.py:L320-L321],Block validation → Sum all transaction gas_used in block → Compare cumulative_gas_used against block header gas_limit → Transaction execution must stop if adding next transaction would exceed gas_limit,,
EIP1559-OBL-019,block_validation,block_validation,Block gas limit change from parent is limited to parent_gas_limit / 1024 (can increase or decrease),[forks/london/fork.py:L855-L892],Block validation → Compare block gas_limit to parent block gas_limit → Calculate max allowed change = parent_gas_limit / 1024 → Validate: parent_gas_limit - max_change <= block_gas_limit <= parent_gas_limit + max_change → Reject block if violation detected,,
EIP1559-OBL-020,block_validation,block_validation,Block gas limit must be at least 5000,"[forks/london/fork.py:L71, forks/london/fork.py:L855-L892]",Block validation → Extract block gas_limit from header → Compare against minimum threshold of 5000 → Reject block if gas_limit < 5000 → Enforced at fork initialization and all subsequent blocks,,
EIP1559-OBL-021,base_fee_calculation,block_validation,"At fork block (FORK_BLOCK_NUMBER), initial base fee per gas is 1000000000","[forks/london/fork.py:L73, forks/london/fork.py:L325-L337]","Fork activation at FORK_BLOCK_NUMBER → Initialize first London block base_fee_per_gas = 1000000000 (1 Gwei) → If FORK_BLOCK_NUMBER > 0, get parent block and apply normal base fee calculation rules",,
EIP1559-OBL-022,base_fee_calculation,block_validation,"At fork block, gas target is parent gas limit (no elasticity multiplier division)",[forks/london/fork.py:L222-L282],Fork activation at FORK_BLOCK_NUMBER → Calculate gas target for first London block → Special case: use parent gas_limit directly (do not divide by elasticity multiplier) → Subsequent blocks use normal gas_target = gas_limit / 2,Spec ambiguity: does 'parent gas limit' mean previous block's gas_limit or previous block's gas_target in calculation?,
EIP1559-OBL-023,base_fee_calculation,block_validation,"When parent gas used equals parent gas target, base fee remains unchanged",[forks/london/fork.py:L254-L280],Base fee calculation → parent_gas_used == parent_gas_target → Delta = 0 → Base fee adjustment = 0 → new_base_fee = parent_base_fee,,
EIP1559-OBL-024,base_fee_calculation,block_validation,"When parent gas used exceeds parent gas target, base fee delta is max(parent_base_fee * gas_used_delta // parent_gas_target // 8, 1)",[forks/london/fork.py:L254-L266],"Base fee calculation → parent_gas_used > parent_gas_target → delta = parent_gas_used - parent_gas_target → increase = max(parent_base_fee * delta // parent_gas_target // 8, 1) → new_base_fee = parent_base_fee + increase",,
EIP1559-OBL-025,base_fee_calculation,block_validation,"When parent gas used is below parent gas target, base fee delta is parent_base_fee * gas_used_delta // parent_gas_target // 8",[forks/london/fork.py:L268-L280],Base fee calculation → parent_gas_used < parent_gas_target → delta = parent_gas_target - parent_gas_used → decrease = parent_base_fee * delta // parent_gas_target // 8 → new_base_fee = parent_base_fee - decrease (minimum 0),,
EIP1559-OBL-026,tx_validation,tx_validation,Signer must have enough balance to cover transaction amount,[forks/london/fork.py:L509-L514],"Transaction validation → Get signer's account balance → Compare against transaction value (amount) → Ensure: balance >= amount → If balance < amount, reject transaction as invalid",,
EIP1559-OBL-027,tx_validation,tx_validation,Signer must have enough balance to cover gas_limit * max_fee_per_gas,[forks/london/fork.py:L439-L518],"Transaction validation → Get signer's account balance → Calculate max_fee_required = gas_limit * max_fee_per_gas → Compare: balance >= max_fee_required → If insufficient, reject transaction before execution",,
EIP1559-OBL-028,tx_validation,tx_validation,Signer must have enough balance to cover gas_limit * effective_gas_price after amount deduction,[forks/london/fork.py:L509-L514],Transaction validation → Get signer's account balance → Deduct transaction amount first → Calculate remaining balance → Calculate gas_fee_required = gas_limit * effective_gas_price → Compare: remaining_balance >= gas_fee_required → Both deductions must fit within original balance,"Specification ambiguity: order of deduction matters for balance validation. Is it amount first then gas, or is it balance >= (amount + gas_fee)?",
EIP1559-OBL-029,tx_validation,tx_validation,max_fee_per_gas must be >= base_fee_per_gas of the block,[forks/london/fork.py:L487-L495],"Transaction validation → Get current block base_fee_per_gas → Extract max_fee_per_gas from transaction → Compare: max_fee_per_gas >= base_fee_per_gas → If max_fee_per_gas < base_fee_per_gas, reject transaction as invalid",,
EIP1559-OBL-030,tx_validation,tx_validation,max_fee_per_gas must be < 2^256 (prevent impossibly large numbers),[forks/london/fork.py:L487-L495],"Transaction parsing → Extract max_fee_per_gas field → Validate: max_fee_per_gas < 2^256 → If max_fee_per_gas >= 2^256, reject as invalid (prevent overflow)",,
EIP1559-OBL-031,tx_validation,tx_validation,max_priority_fee_per_gas must be < 2^256 (prevent impossibly large numbers),[forks/london/fork.py:L487-L495],"Transaction parsing → Extract max_priority_fee_per_gas field → Validate: max_priority_fee_per_gas < 2^256 → If max_priority_fee_per_gas >= 2^256, reject as invalid (prevent overflow)",,
EIP1559-OBL-032,tx_validation,tx_validation,max_fee_per_gas must be >= max_priority_fee_per_gas,[forks/london/fork.py:L487-L495],"Transaction validation → Extract max_fee_per_gas and max_priority_fee_per_gas → Compare: max_fee_per_gas >= max_priority_fee_per_gas → If max_fee_per_gas < max_priority_fee_per_gas, reject as invalid (priority fee cannot exceed total fee)",,
EIP1559-OBL-033,block_validation,block_validation,Block cumulative gas used must equal sum of gas used in all transactions,[forks/london/fork.py:L202-L205],"Block validation → Initialize cumulative_gas = 0 → For each transaction in block: add gas_used to cumulative_gas → After all transactions, compare block cumulative_gas_used field to calculated cumulative_gas → Must match exactly",,
EIP1559-OBL-034,gas_refund,execution_semantics,Signer is refunded for unused gas at effective_gas_price,"[forks/london/fork.py:L801-L807, forks/london/fork.py:L814-L817]",Transaction execution completes → gas_refund = (gas_limit - gas_used) → refund_amount = gas_refund * effective_gas_price → Transfer refund_amount to signer's account → Refund is paid at the effective gas price (base + priority fee),,
EIP1559-OBL-035,opcode_compatibility,execution_semantics,GASPRICE opcode (0x3a) must return effective_gas_price,[forks/london/vm/instructions/environment.py:L304-L324],GASPRICE opcode (0x3a) is called within transaction execution → EVM retrieves effective_gas_price from transaction/block context → Returns value to smart contract or caller,,
