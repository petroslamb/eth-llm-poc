"id","category","enforcement_type","statement","locations","code_flow","obligation_gap","code_gap","client_locations","client_code_flow","client_obligation_gap","client_code_gap"
"EIP1559-OBL-001","execution semantics","opcode behavior","The GASPRICE (0x3a) opcode MUST return the effective_gas_price as defined in the reference implementation.","[vm/instructions/environment.py:gasprice, vm/__init__.py:TransactionEnvironment.gas_price, fork.py:check_transaction]","state_transition() -> apply_body() -> process_transaction() -> check_transaction() computes effective_gas_price; TransactionEnvironment.gas_price is set to effective_gas_price; gasprice opcode in environment.py:304-324 pushes evm.message.tx_env.gas_price to stack","","","[core/vm/instructions.go:L419-L423:opGasprice, core/state_transition.go:L176-L199:TransactionToMessage]","TransactionToMessage() computes effective gas price as min(gasTipCap, gasFeeCap-baseFee)+baseFee and stores in msg.GasPrice; opGasprice() reads evm.GasPrice (set from msg.GasPrice via NewEVMTxContext) and pushes to stack","",""
"EIP1559-OBL-002","tx validation","transaction type detection","As of FORK_BLOCK_NUMBER, a new EIP-2718 transaction is introduced with TransactionType 2.","[transactions.py:FeeMarketTransaction, transactions.py:decode_transaction, transactions.py:encode_transaction, __init__.py:FORK_CRITERIA]","decode_transaction() at transactions.py:309-325 checks tx[0]==2 and returns FeeMarketTransaction; encode_transaction() at transactions.py:291-306 prefixes with b'\x02'; FORK_CRITERIA in __init__.py:48 sets ByBlockNumber(12965000)","","","[core/types/transaction.go:L50:DynamicFeeTxType, core/types/transaction.go:L200-L220:decodeTyped, core/types/tx_dynamic_fee.go:L28-L43:DynamicFeeTx]","DynamicFeeTxType=0x02 defined in transaction.go:L50; decodeTyped() checks first byte and instantiates DynamicFeeTx for type 2; Transaction.UnmarshalBinary() dispatches to decodeTyped for typed txs","",""
"EIP1559-OBL-003","fees","intrinsic gas calculation","The intrinsic cost of the new transaction type 2 is 21000 + 16 * non-zero calldata bytes + 4 * zero calldata bytes + 1900 * access list storage key count + 2400 * access list address count.","[transactions.py:calculate_intrinsic_cost, transactions.py:TX_BASE_COST, transactions.py:TX_DATA_COST_PER_NON_ZERO, transactions.py:TX_DATA_COST_PER_ZERO, transactions.py:TX_ACCESS_LIST_STORAGE_KEY_COST, transactions.py:TX_ACCESS_LIST_ADDRESS_COST]","calculate_intrinsic_cost() at transactions.py:359-402 sums TX_BASE_COST(21000) + data_cost (16/4 per byte) + access_list_cost (2400 per address, 1900 per slot)","","","[core/state_transition.go:L71-L117:IntrinsicGas, params/protocol_params.go:L38-L100]","IntrinsicGas() computes: TxGas(21000) + TxDataNonZeroGasEIP2028(16)*nz + TxDataZeroGas(4)*z + TxAccessListAddressGas(2400)*addrs + TxAccessListStorageKeyGas(1900)*keys","",""
"EIP1559-OBL-004","tx validation","RLP encoding","The EIP-2718 TransactionPayload for type 2 transactions is rlp([chain_id, nonce, max_priority_fee_per_gas, max_fee_per_gas, gas_limit, destination, amount, data, access_list, signature_y_parity, signature_r, signature_s]).","[transactions.py:FeeMarketTransaction, transactions.py:encode_transaction]","FeeMarketTransaction dataclass at transactions.py:208-282 defines fields in spec order; encode_transaction() at transactions.py:303-304 returns b'\x02' + rlp.encode(tx)","","","[core/types/tx_dynamic_fee.go:L28-L43:DynamicFeeTx, core/types/tx_dynamic_fee.go:L119-L125:encode/decode]","DynamicFeeTx struct defines fields matching EIP-1559 order: ChainID, Nonce, GasTipCap, GasFeeCap, Gas, To, Value, Data, AccessList, V, R, S; encode() calls rlp.Encode(b, tx)","",""
"EIP1559-OBL-005","tx validation","signature verification","The signature_y_parity, signature_r, signature_s elements of a type 2 transaction represent a secp256k1 signature over keccak256(0x02 || rlp([chain_id, nonce, max_priority_fee_per_gas, max_fee_per_gas, gas_limit, destination, amount, data, access_list])).","[transactions.py:signing_hash_1559, transactions.py:recover_sender]","signing_hash_1559() at transactions.py:533-557 computes keccak256(b'\x02' + rlp.encode(...)); recover_sender() at transactions.py:447-452 uses secp256k1_recover with signing_hash_1559(tx)","","","[core/types/tx_dynamic_fee.go:L127-L141:sigHash, core/types/transaction_signing.go:L134-L157:Sender]","sigHash() computes prefixedRlpHash(DynamicFeeTxType, [...fields...]) = keccak256(0x02 || rlp([...])); Sender() recovers address via signer.Sender() using signature values","",""
"EIP1559-OBL-006","tx validation","receipt encoding","The EIP-2718 ReceiptPayload for type 2 transactions is rlp([status, cumulative_transaction_gas_used, logs_bloom, logs]).","[blocks.py:Receipt, blocks.py:encode_receipt]","Receipt dataclass at blocks.py:262-291 defines succeeded, cumulative_gas_used, bloom, logs; encode_receipt() at blocks.py:294-308 returns b'\x02' + rlp.encode(receipt) for FeeMarketTransaction","","","[core/types/receipt.go:L90-L96:receiptRLP, core/types/receipt.go:L137-L141:encodeTyped, core/types/receipt.go:L207-L218:decodeTyped]","receiptRLP struct contains PostStateOrStatus, CumulativeGasUsed, Bloom, Logs; encodeTyped() writes type byte followed by rlp.Encode(w, data) for DynamicFeeTxType receipts","",""
"EIP1559-OBL-007","block validation","header validation","A block's gas_used must not exceed its gas_limit.","[fork.py:validate_header:L320-L321]","validate_header() at fork.py:320-321 checks if header.gas_used > header.gas_limit and raises InvalidBlock","","","[consensus/misc/eip1559/eip1559.go:L33-L53:VerifyEIP1559Header, core/blockchain.go:verifyHeader]","VerifyEIP1559Header() calls misc.VerifyGaslimit() which checks header.GasUsed is within bounds; block validation happens in blockchain.go via engine.VerifyHeader","",""
"EIP1559-OBL-008","block validation","gas limit bounds","A block's gas_limit must be less than parent_gas_limit + parent_gas_limit // 1024.","[fork.py:check_gas_limit:L884-L886, fork.py:GAS_LIMIT_ADJUSTMENT_FACTOR]","check_gas_limit() at fork.py:884-886 computes max_adjustment_delta = parent_gas_limit // GAS_LIMIT_ADJUSTMENT_FACTOR(1024) and returns False if gas_limit >= parent_gas_limit + max_adjustment_delta","","","[consensus/misc/gaslimit.go:L27-L41:VerifyGaslimit, params/protocol_params.go:L26:GasLimitBoundDivisor]","VerifyGaslimit() computes limit = parentGasLimit / GasLimitBoundDivisor(1024); returns error if diff >= limit (i.e., gasLimit >= parent + parent/1024)","",""
"EIP1559-OBL-009","block validation","gas limit bounds","A block's gas_limit must be greater than parent_gas_limit - parent_gas_limit // 1024.","[fork.py:check_gas_limit:L887-L888, fork.py:GAS_LIMIT_ADJUSTMENT_FACTOR]","check_gas_limit() at fork.py:887-888 returns False if gas_limit <= parent_gas_limit - max_adjustment_delta","","","[consensus/misc/gaslimit.go:L27-L41:VerifyGaslimit, params/protocol_params.go:L26:GasLimitBoundDivisor]","VerifyGaslimit() computes limit = parentGasLimit / GasLimitBoundDivisor(1024); returns error if diff >= limit (covers both upper and lower bounds)","",""
"EIP1559-OBL-010","block validation","gas limit minimum","A block's gas_limit must be at least 5000.","[fork.py:check_gas_limit:L889-L890, fork.py:GAS_LIMIT_MINIMUM]","check_gas_limit() at fork.py:889-890 returns False if gas_limit < GAS_LIMIT_MINIMUM(5000)","","","[consensus/misc/gaslimit.go:L37-L39:MinGasLimit check, params/protocol_params.go:L27:MinGasLimit]","VerifyGaslimit() at L37-39 checks if headerGasLimit < params.MinGasLimit(5000) and returns error","",""
"EIP1559-OBL-011","base fee adjustment","fork initialization","At the fork block (INITIAL_FORK_BLOCK_NUMBER), the base_fee_per_gas must equal INITIAL_BASE_FEE (1000000000 wei).","[fork.py:validate_header:L325-L326, fork.py:INITIAL_BASE_FEE]","validate_header() at fork.py:325-326 sets expected_base_fee_per_gas = INITIAL_BASE_FEE when header.number == FORK_CRITERIA.block_number; INITIAL_BASE_FEE = Uint(1000000000) at fork.py:73","","","[consensus/misc/eip1559/eip1559.go:L56-L60:CalcBaseFee, params/protocol_params.go:L135:InitialBaseFee]","CalcBaseFee() checks if !config.IsLondon(parent.Number) and returns params.InitialBaseFee(1000000000) for first EIP-1559 block","",""
"EIP1559-OBL-012","base fee adjustment","base fee calculation","When parent_gas_used equals parent_gas_target, the expected_base_fee_per_gas equals parent_base_fee_per_gas.","[fork.py:calculate_base_fee_per_gas:L252-L253]","calculate_base_fee_per_gas() at fork.py:252-253 checks if parent_gas_used == parent_gas_target and returns parent_base_fee_per_gas","","","[consensus/misc/eip1559/eip1559.go:L62-L66:CalcBaseFee]","CalcBaseFee() computes parentGasTarget = parent.GasLimit / ElasticityMultiplier; if parent.GasUsed == parentGasTarget, returns parent.BaseFee unchanged","",""
"EIP1559-OBL-013","base fee adjustment","base fee calculation","When parent_gas_used exceeds parent_gas_target, the base_fee_per_gas must increase by max(parent_base_fee_per_gas * gas_used_delta // parent_gas_target // BASE_FEE_MAX_CHANGE_DENOMINATOR, 1).","[fork.py:calculate_base_fee_per_gas:L254-L267, fork.py:BASE_FEE_MAX_CHANGE_DENOMINATOR]","calculate_base_fee_per_gas() at fork.py:254-267 computes gas_used_delta, then base_fee_per_gas_delta = max(parent_base_fee_per_gas * gas_used_delta // parent_gas_target // BASE_FEE_MAX_CHANGE_DENOMINATOR(8), 1)","","","[consensus/misc/eip1559/eip1559.go:L73-L83:CalcBaseFee increase path]","When parent.GasUsed > parentGasTarget: delta = (gasUsed-target)*baseFee/target/BaseFeeChangeDenominator(8); returns max(1, delta) + parent.BaseFee","",""
"EIP1559-OBL-014","base fee adjustment","base fee calculation","When parent_gas_used is below parent_gas_target, the base_fee_per_gas must decrease by parent_base_fee_per_gas * gas_used_delta // parent_gas_target // BASE_FEE_MAX_CHANGE_DENOMINATOR.","[fork.py:calculate_base_fee_per_gas:L268-L280, fork.py:BASE_FEE_MAX_CHANGE_DENOMINATOR]","calculate_base_fee_per_gas() at fork.py:268-280 computes gas_used_delta = parent_gas_target - parent_gas_used, then subtracts base_fee_per_gas_delta from parent_base_fee_per_gas","","","[consensus/misc/eip1559/eip1559.go:L84-L97:CalcBaseFee decrease path]","When parent.GasUsed < parentGasTarget: delta = (target-gasUsed)*baseFee/target/BaseFeeChangeDenominator(8); returns max(0, parent.BaseFee - delta)","",""
"EIP1559-OBL-015","block validation","header validation","A block's base_fee_per_gas must match the expected_base_fee_per_gas calculated from the parent block.","[fork.py:validate_header:L336-L337, fork.py:calculate_base_fee_per_gas]","validate_header() at fork.py:336-337 calls calculate_base_fee_per_gas() and raises InvalidBlock if expected_base_fee_per_gas != header.base_fee_per_gas","","","[consensus/misc/eip1559/eip1559.go:L47-L52:VerifyEIP1559Header baseFee check]","VerifyEIP1559Header() calls CalcBaseFee() and compares result with header.BaseFee; returns error if mismatch","",""
"EIP1559-OBL-016","tx validation","balance check","After deducting transaction.amount from signer.balance, the balance must be non-negative.","[fork.py:check_transaction:L513-L514]","check_transaction() at fork.py:513-514 checks Uint(sender_account.balance) < max_gas_fee + Uint(tx.value) and raises InsufficientBalanceError","","","[core/state_transition.go:L266-L308:buyGas, core/txpool/validation.go:L269-L276:balance check]","buyGas() adds msg.Value to balanceCheck and compares with sender balance; ValidateTransactionWithState() checks balance >= tx.Cost() which includes value","",""
"EIP1559-OBL-017","tx validation","balance check","The signer's balance must be at least transaction.gas_limit * transaction.max_fee_per_gas.","[fork.py:check_transaction:L502-L514]","check_transaction() at fork.py:502-507 computes max_gas_fee = tx.gas * tx.max_fee_per_gas for FeeMarketTransaction, then at L513-514 validates sender_account.balance >= max_gas_fee + tx.value","","","[core/state_transition.go:L266-L294:buyGas]","buyGas() computes balanceCheck = gasLimit * GasFeeCap + value; checks state.GetBalance(from) >= balanceCheck","",""
"EIP1559-OBL-018","tx validation","fee validation","A transaction's max_fee_per_gas must be greater than or equal to block.base_fee_per_gas.","[fork.py:check_transaction:L492-L495, exceptions.py:InsufficientMaxFeePerGasError]","check_transaction() at fork.py:492-495 checks if tx.max_fee_per_gas < block_env.base_fee_per_gas and raises InsufficientMaxFeePerGasError","","","[core/state_transition.go:L341-L362:preCheck, core/errors.go:ErrFeeCapTooLow]","preCheck() at L359-362 checks msg.GasFeeCap.Cmp(st.evm.Context.BaseFee) < 0 and returns ErrFeeCapTooLow","",""
"EIP1559-OBL-019","tx validation","type constraint","A transaction's max_fee_per_gas must be less than 2^256.","[transactions.py:FeeMarketTransaction.max_fee_per_gas]","FeeMarketTransaction.max_fee_per_gas at transactions.py:235 is typed as Uint which is unbounded; constraint enforced by RLP decoding limits","Spec states < 2^256 but Uint type is unbounded","RLP decoding may allow values exceeding practical limits","[core/state_transition.go:L345-L348:preCheck, core/txpool/validation.go:L105-L106]","preCheck() checks msg.GasFeeCap.BitLen() > 256 and returns ErrFeeCapVeryHigh; ValidateTransaction() performs same check","",""
"EIP1559-OBL-020","tx validation","type constraint","A transaction's max_priority_fee_per_gas must be less than 2^256.","[transactions.py:FeeMarketTransaction.max_priority_fee_per_gas]","FeeMarketTransaction.max_priority_fee_per_gas at transactions.py:230 is typed as Uint which is unbounded; constraint enforced by RLP decoding limits","Spec states < 2^256 but Uint type is unbounded","RLP decoding may allow values exceeding practical limits","[core/state_transition.go:L349-L352:preCheck, core/txpool/validation.go:L107-L109]","preCheck() checks msg.GasTipCap.BitLen() > 256 and returns ErrTipVeryHigh; ValidateTransaction() performs same check","",""
"EIP1559-OBL-021","tx validation","fee validation","A transaction's max_fee_per_gas must be greater than or equal to its max_priority_fee_per_gas.","[fork.py:check_transaction:L487-L491, exceptions.py:PriorityFeeGreaterThanMaxFeeError]","check_transaction() at fork.py:488-491 checks if tx.max_fee_per_gas < tx.max_priority_fee_per_gas and raises PriorityFeeGreaterThanMaxFeeError","","","[core/state_transition.go:L353-L356:preCheck, core/txpool/validation.go:L111-L114]","preCheck() checks msg.GasFeeCap.Cmp(msg.GasTipCap) < 0 and returns ErrTipAboveFeeCap; ValidateTransaction() performs same check","",""
"EIP1559-OBL-022","tx validation","balance check","After deducting gas costs from signer.balance, the balance must be non-negative.","[fork.py:check_transaction:L513-L514, fork.py:process_transaction:L772-L777]","check_transaction() validates upfront at L513-514; process_transaction() at L772-777 deducts effective_gas_fee from sender_balance_after_gas_fee","","","[core/state_transition.go:L266-L308:buyGas]","buyGas() checks balance >= balanceCheck (gasLimit * gasFeeCap + value) before deducting mgval (gasLimit * gasPrice) from sender balance","",""
"EIP1559-OBL-023","fees","fee calculation","The priority_fee_per_gas is calculated as min(transaction.max_priority_fee_per_gas, transaction.max_fee_per_gas - block.base_fee_per_gas).","[fork.py:check_transaction:L497-L500]","check_transaction() at fork.py:497-500 computes priority_fee_per_gas = min(tx.max_priority_fee_per_gas, tx.max_fee_per_gas - block_env.base_fee_per_gas)","","","[core/state_transition.go:L193-L199:TransactionToMessage, core/types/tx_dynamic_fee.go:L100-L109:effectiveGasPrice]","TransactionToMessage() sets msg.GasPrice = min(gasTipCap, gasFeeCap-baseFee) + baseFee; effectiveGasPrice() computes tip=min(gasFeeCap-baseFee, gasTipCap)","",""
"EIP1559-OBL-024","fees","fee calculation","The effective_gas_price is calculated as priority_fee_per_gas + block.base_fee_per_gas.","[fork.py:check_transaction:L501]","check_transaction() at fork.py:501 computes effective_gas_price = priority_fee_per_gas + block_env.base_fee_per_gas","","","[core/state_transition.go:L193-L199:TransactionToMessage, core/types/tx_dynamic_fee.go:L100-L109:effectiveGasPrice]","effectiveGasPrice() returns tip.Add(tip, baseFee) = priority_fee + baseFee; TransactionToMessage() stores in msg.GasPrice","",""
"EIP1559-OBL-025","fees","balance deduction","The signer's balance must be debited by transaction.gas_limit * effective_gas_price upfront before execution.","[fork.py:process_transaction:L767-L777]","process_transaction() at fork.py:767-777 computes effective_gas_fee = tx.gas * effective_gas_price, then sets sender_balance_after_gas_fee and calls set_account_balance()","","","[core/state_transition.go:L266-L308:buyGas]","buyGas() computes mgval = gasLimit * msg.GasPrice (effectiveGasPrice); calls state.SubBalance(msg.From, mgvalU256, BalanceDecreaseGasBuy)","",""
"EIP1559-OBL-026","fees","refund mechanism","After transaction execution, the signer must be refunded gas_refund * effective_gas_price for unused gas.","[fork.py:process_transaction:L801-L817]","process_transaction() at fork.py:801-817 computes tx_gas_left, gas_refund_amount = tx_gas_left * effective_gas_price, then adds to sender_balance_after_refund","","","[core/state_transition.go:L655-L667:returnGas]","returnGas() computes remaining = gasRemaining * msg.GasPrice; calls state.AddBalance(msg.From, remaining, BalanceIncreaseGasReturn)","",""
"EIP1559-OBL-027","fees","miner payment","The miner (block author) must receive gas_used * priority_fee_per_gas.","[fork.py:process_transaction:L810-L828]","process_transaction() at fork.py:810-811 computes priority_fee_per_gas = effective_gas_price - block_env.base_fee_per_gas; L811 computes transaction_fee = tx_gas_used_after_refund * priority_fee_per_gas; L819-828 adds to coinbase_balance","","","[core/state_transition.go:L547-L566:execute miner payment]","execute() computes effectiveTip = msg.GasPrice - baseFee; fee = gasUsed * effectiveTip; calls state.AddBalance(Coinbase, fee, BalanceIncreaseRewardTransactionFee)","",""
"EIP1559-OBL-028","fees","fee burning","The base_fee_per_gas is burned (not given to anyone).","[fork.py:process_transaction:L810-L811]","process_transaction() at fork.py:810-811 computes transaction_fee using only priority_fee_per_gas, excluding base_fee_per_gas which is implicitly burned (never credited to any account)","","","[core/state_transition.go:L547-L566:execute]","execute() pays only effectiveTip (gasPrice - baseFee) to coinbase; baseFee portion is implicitly burned by not being credited to any account","",""
"EIP1559-OBL-029","block validation","receipt validation","The cumulative_transaction_gas_used must equal the block's gas_used field.","[fork.py:state_transition:L202-L205, blocks.py:Receipt.cumulative_gas_used]","state_transition() at fork.py:202-205 checks if block_output.block_gas_used != block.header.gas_used; Receipt.cumulative_gas_used tracks running total per-tx","","","[core/state_processor.go:L165:usedGas update, core/types/receipt.go:L58:CumulativeGasUsed]","ApplyTransactionWithEVM() adds result.UsedGas to usedGas; MakeReceipt() sets receipt.CumulativeGasUsed = usedGas; ProcessResult returns GasUsed which must match header.GasUsed","",""
"EIP1559-OBL-030","base fee adjustment","fork transition","On the fork block, the parent_gas_target is set to parent.gas_limit (not divided by ELASTICITY_MULTIPLIER).","[fork.py:validate_header:L323-L334]","validate_header() at fork.py:325-326 uses INITIAL_BASE_FEE directly for fork block; for non-fork blocks at L329-334, calculate_base_fee_per_gas() receives parent_header.gas_limit as parent_gas_limit","Spec describes parent_gas_target handling on fork block but code uses INITIAL_BASE_FEE directly","Code does not explicitly set parent_gas_target = parent.gas_limit; handled implicitly via INITIAL_BASE_FEE","[consensus/misc/eip1559/eip1559.go:L35-L38:VerifyEIP1559Header fork transition]","VerifyEIP1559Header() at L35-38: if !config.IsLondon(parent.Number), multiplies parentGasLimit by ElasticityMultiplier to handle fork transition","",""
"EIP1559-OBL-031","base fee adjustment","fork transition","On the fork block, the parent_gas_limit is set to parent.gas_limit * ELASTICITY_MULTIPLIER.","[fork.py:validate_header:L323-L334]","validate_header() at fork.py:325-326 uses INITIAL_BASE_FEE directly for fork block, bypassing gas limit calculation; for subsequent blocks, calculate_base_fee_per_gas() is called","Spec describes doubling parent_gas_limit on fork block but code uses INITIAL_BASE_FEE shortcut","Code does not explicitly double parent_gas_limit; handled implicitly via INITIAL_BASE_FEE","[consensus/misc/eip1559/eip1559.go:L35-L38:VerifyEIP1559Header fork transition]","VerifyEIP1559Header() at L35-38: parentGasLimit = parent.GasLimit * config.ElasticityMultiplier() when !config.IsLondon(parent.Number)","",""
"EIP1559-OBL-032","base fee adjustment","constant definition","The gas_target for a block is calculated as gas_limit // ELASTICITY_MULTIPLIER (where ELASTICITY_MULTIPLIER = 2).","[fork.py:calculate_base_fee_per_gas:L248, fork.py:ELASTICITY_MULTIPLIER]","calculate_base_fee_per_gas() at fork.py:248 computes parent_gas_target = parent_gas_limit // ELASTICITY_MULTIPLIER; ELASTICITY_MULTIPLIER = Uint(2) at fork.py:69","","","[consensus/misc/eip1559/eip1559.go:L62:CalcBaseFee, params/config.go:ElasticityMultiplier]","CalcBaseFee() computes parentGasTarget = parent.GasLimit / config.ElasticityMultiplier(); ElasticityMultiplier defaults to 2 via DefaultElasticityMultiplier","",""
"EIP1559-OBL-033","base fee adjustment","constant definition","The BASE_FEE_MAX_CHANGE_DENOMINATOR constant equals 8.","[fork.py:BASE_FEE_MAX_CHANGE_DENOMINATOR]","BASE_FEE_MAX_CHANGE_DENOMINATOR = Uint(8) defined at fork.py:68","","","[params/protocol_params.go:L133:DefaultBaseFeeChangeDenominator, params/config.go:BaseFeeChangeDenominator]","DefaultBaseFeeChangeDenominator = 8 in protocol_params.go; config.BaseFeeChangeDenominator() returns this value (or chain-specific override)","",""
"EIP1559-OBL-034","tx validation","signature validation","Transaction signature and chain ID must be validated before normalizing the transaction.","[transactions.py:recover_sender]","recover_sender() at transactions.py:405-454 validates r, s bounds, y_parity values, and chain_id matching before recovering public key; called from check_transaction() at fork.py:484","","","[core/types/transaction_signing.go:L134-L157:Sender, core/txpool/validation.go:L115-L118]","Sender() via signer.Sender(tx) validates signature and recovers address before tx processing; ValidateTransaction() calls Sender() and returns ErrInvalidSender on failure","",""
"EIP1559-OBL-035","tx validation","legacy tx normalization","Legacy transactions must be normalized with gas_price mapped to both max_priority_fee_per_gas and max_fee_per_gas.","[fork.py:check_transaction:L503-L507]","check_transaction() at fork.py:504-507 handles non-FeeMarketTransaction by using tx.gas_price directly as effective_gas_price, which achieves same effect as max_fee = max_priority_fee = gas_price","","","[core/types/tx_legacy.go:L100-L102:gasTipCap/gasFeeCap, core/state_transition.go:L176-L199:TransactionToMessage]","LegacyTx.gasTipCap() and gasFeeCap() both return GasPrice; TransactionToMessage() copies these to msg.GasTipCap and msg.GasFeeCap, effectively normalizing legacy tx","",""
"EIP1559-OBL-036","tx validation","EIP-2930 tx normalization","EIP-2930 transactions must be normalized with gas_price mapped to both max_priority_fee_per_gas and max_fee_per_gas.","[fork.py:check_transaction:L503-L507]","check_transaction() at fork.py:504-507 handles AccessListTransaction same as legacy: tx.gas_price used directly as effective_gas_price","","","[core/types/tx_access_list.go:gasTipCap/gasFeeCap, core/state_transition.go:L176-L199:TransactionToMessage]","AccessListTx.gasTipCap() and gasFeeCap() both return GasPrice; TransactionToMessage() copies these, normalizing EIP-2930 tx same as legacy","",""
