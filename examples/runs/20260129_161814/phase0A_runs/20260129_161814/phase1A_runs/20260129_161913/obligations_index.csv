id,category,enforcement_type,statement,locations,code_flow,obligation_gap,code_gap
EIP2930-OBL-001,tx validation,format constraint,EIP-2930 transactions MUST use TransactionType 1.,"[transactions.py:L224, transactions.py:L238-L240, exceptions.py:L10-L24]",,,
EIP2930-OBL-002,tx validation,format constraint,"The EIP-2718 TransactionPayload for type 1 transactions MUST be rlp([chainId, nonce, gasPrice, gasLimit, to, value, data, accessList, signatureYParity, signatureR, signatureS]).","[transactions.py:L137-L204, transactions.py:L223-L224, transactions.py:L240]",,,
EIP2930-OBL-003,tx validation,signature validation,"The signature elements (signatureYParity, signatureR, signatureS) MUST represent a secp256k1 signature over keccak256(0x01 || rlp([chainId, nonce, gasPrice, gasLimit, to, value, data, accessList])).","[transactions.py:L358-L363, transactions.py:L418-L441, transactions.py:L336-L340]",,,
EIP2930-OBL-004,tx validation,format constraint,"The EIP-2718 ReceiptPayload for type 1 transactions MUST be rlp([status, cumulativeGasUsed, logsBloom, logs]).","[blocks.py:L238-L268, blocks.py:L270-L281]",,,
EIP2930-OBL-005,tx validation,format constraint,"For the transaction to be valid, accessList MUST be of type [[{20 bytes}, [{32 bytes}...]]...] (a list of [address, storage_keys] pairs where address is 20 bytes and each storage key is 32 bytes).","[transactions.py:L116-L133, transactions.py:L185]",,,
EIP2930-OBL-006,tx validation,format constraint,Each item in the accessList MUST be a list of exactly 2 elements.,[transactions.py:L116-L133],,,
EIP2930-OBL-007,tx validation,format constraint,Each address in the accessList MUST be exactly 20 bytes.,[transactions.py:L124],,,
EIP2930-OBL-008,tx validation,format constraint,The storage keys element of each accessList item MUST be a list.,[transactions.py:L129],,,
EIP2930-OBL-009,tx validation,format constraint,Each storage key in the accessList MUST be exactly 32 bytes.,[transactions.py:L129],,,
EIP2930-OBL-010,fees,gas charging,ACCESS_LIST_ADDRESS_COST (2400 gas) MUST be charged for each address in the access list.,"[transactions.py:L47-L49, transactions.py:L312-L314]",,,
EIP2930-OBL-011,fees,gas charging,ACCESS_LIST_STORAGE_KEY_COST (1900 gas) MUST be charged for each storage key in the access list.,"[transactions.py:L52-L55, transactions.py:L315-L317]",,,
EIP2930-OBL-012,fees,gas charging,The access list gas charge MUST occur at the beginning of execution (at the same time as the intrinsic gas is charged according to EIP-2028 rules).,"[transactions.py:L276-L319, fork.py:L638, transactions.py:L268-L270]",,,
EIP2930-OBL-013,execution semantics,,Addresses from the access list MUST be immediately loaded into the accessed_addresses global set at the beginning of execution.,"[fork.py:L657-L661, utils/message.py:L49-L52, vm/__init__.py:L90, vm/interpreter.py:L242]",,,
EIP2930-OBL-014,execution semantics,,Storage keys from the access list MUST be immediately loaded into the accessed_storage_keys global set at the beginning of execution (as address-key pairs).,"[fork.py:L657-L663, utils/message.py:L88, vm/__init__.py:L91, vm/interpreter.py:L243]",,,
EIP2930-OBL-015,fees,gas charging,Non-unique addresses and storage keys in the access list MUST be charged for multiple times.,[transactions.py:L311-L317],,,
EIP2930-OBL-016,fees,,The access list MUST NOT be charged per-byte fees like transaction data.,"[transactions.py:L298-L305, transactions.py:L311-L317]",,,
EIP2930-OBL-017,block validation,,Type 1 transactions with access lists MUST only be valid as of FORK_BLOCK 12244000.,[],,,
EIP2930-OBL-018,tx validation,format constraint,The transaction MUST only be valid on networks with the specified chainID.,"[transactions.py:L148, fork.py:L388]",,,
EIP2930-OBL-019,tx validation,format constraint,YParity MUST be 0 for even or 1 for odd y-value of the secp256k1 signature.,"[transactions.py:L359-L360, transactions.py:L191]",,,
