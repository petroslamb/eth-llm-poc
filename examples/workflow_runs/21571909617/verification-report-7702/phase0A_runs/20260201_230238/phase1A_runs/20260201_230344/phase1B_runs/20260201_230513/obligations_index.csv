id,category,enforcement_type,statement,locations,code_flow,obligation_gap,code_gap
EIP7702-OBL-001,tx validation,type-identifier,The TransactionType for a set code transaction MUST be SET_CODE_TX_TYPE (0x04).,"[transactions.py:L494, transactions.py:L514-L515]",fork.py:apply_body() -> fork.py:process_transaction() -> transactions.py:encode_transaction() [L493-494: SetCodeTransaction returns b'\x04' prefix]; transactions.py:decode_transaction() [L514-515: tx[0]==4 decodes to SetCodeTransaction],,
EIP7702-OBL-002,tx validation,struct-definition,"The TransactionPayload MUST be the RLP serialization of [chain_id, nonce, max_priority_fee_per_gas, max_fee_per_gas, gas_limit, destination, value, data, access_list, authorization_list, signature_y_parity, signature_r, signature_s].","[transactions.py:L382-L462, transactions.py:L838-L863]",fork.py:apply_body() -> fork.py:process_transaction() -> transactions.py:decode_transaction() -> ethereum_rlp.decode_to(SetCodeTransaction) [L515]; SetCodeTransaction dataclass [L382-462] defines RLP fields; transactions.py:signing_hash_7702() [L838-863] encodes fields in order,,
EIP7702-OBL-003,tx validation,explicit-check,A set code transaction MUST have a non-null destination.,"[fork.py:L506-L508, transactions.py:L420]",fork.py:apply_body() -> fork.py:process_transaction() -> fork.py:check_transaction() [L506-508: raises TransactionTypeContractCreationError if tx.to is not Address]; SetCodeTransaction.to typed as Address [L420],,
EIP7702-OBL-004,tx validation,crypto-verification,The transaction signature MUST be a secp256k1 signature over keccak256(SET_CODE_TX_TYPE || TransactionPayload).,"[transactions.py:L696-L701, transactions.py:L838-L863]",fork.py:apply_body() -> fork.py:process_transaction() -> fork.py:check_transaction() -> transactions.py:recover_sender() [L696-701: for SetCodeTransaction calls secp256k1_recover with signing_hash_7702]; signing_hash_7702() [L838-863: computes keccak256(b'\x04' || rlp(...))],,
EIP7702-OBL-005,tx validation,explicit-check,The transaction is invalid if the length of authorization_list is zero.,"[fork.py:L510-L512, exceptions.py:L106-L109]",fork.py:apply_body() -> fork.py:process_transaction() -> fork.py:check_transaction() [L510-512: if not any(tx.authorizations) raises EmptyAuthorizationListError]; exceptions.py:EmptyAuthorizationListError [L106-109],,
EIP7702-OBL-006,tx validation,type-constraint,The authorization tuple chain_id field MUST be less than 2**256.,[fork_types.py:L73],RLP decode -> fork_types.py:Authorization [L73: chain_id: U256] - U256 type constraint enforces < 2**256,,
EIP7702-OBL-007,tx validation,type-constraint,The authorization tuple nonce field MUST be less than 2**64.,[fork_types.py:L75],RLP decode -> fork_types.py:Authorization [L75: nonce: U64] - U64 type constraint enforces < 2**64,,
EIP7702-OBL-008,tx validation,type-constraint,The authorization tuple address field MUST be exactly 20 bytes.,[fork_types.py:L74],RLP decode -> fork_types.py:Authorization [L74: address: Address] - Address = Bytes20 enforces exactly 20 bytes,,
EIP7702-OBL-009,tx validation,type-constraint,The authorization tuple y_parity field MUST be less than 2**8.,[fork_types.py:L76],RLP decode -> fork_types.py:Authorization [L76: y_parity: U8] - U8 type constraint enforces < 2**8,,
EIP7702-OBL-010,tx validation,type-constraint,The authorization tuple r field MUST be less than 2**256.,[fork_types.py:L77],RLP decode -> fork_types.py:Authorization [L77: r: U256] - U256 type constraint enforces < 2**256,,
EIP7702-OBL-011,tx validation,type-constraint,The authorization tuple s field MUST be less than 2**256.,[fork_types.py:L78],RLP decode -> fork_types.py:Authorization [L78: s: U256] - U256 type constraint enforces < 2**256,,
EIP7702-OBL-012,execution semantics,control-flow-ordering,"The authorization list MUST be processed before the execution portion of the transaction begins, but after the sender's nonce is incremented.","[vm/interpreter.py:L126-L127, fork.py:L879]",fork.py:process_transaction() -> fork.py:prepare_message() -> vm/interpreter.py:process_message_call() [L126-127: calls set_delegation(message) before process_message()]; fork.py:process_transaction() [L879: increment_nonce called before prepare_message],,
EIP7702-OBL-013,execution semantics,explicit-check,"For each authorization tuple, the chain ID MUST be verified to be 0 or the ID of the current chain.",[vm/eoa_delegation.py:L172-L173],"vm/interpreter.py:process_message_call() -> vm/eoa_delegation.py:set_delegation() [L172-173: if auth.chain_id not in (message.block_env.chain_id, U256(0)): continue]",,
EIP7702-OBL-014,execution semantics,explicit-check,"For each authorization tuple, the nonce MUST be verified to be less than 2**64 - 1.",[vm/eoa_delegation.py:L175-L176],vm/interpreter.py:process_message_call() -> vm/eoa_delegation.py:set_delegation() [L175-176: if auth.nonce >= U64.MAX_VALUE: continue],,
EIP7702-OBL-015,execution semantics,crypto-verification,"The authority address MUST be recovered using ecrecover(msg, y_parity, r, s) where msg = keccak(MAGIC || rlp([chain_id, address, nonce])).",[vm/eoa_delegation.py:L102-L114],"vm/interpreter.py:process_message_call() -> vm/eoa_delegation.py:set_delegation() -> vm/eoa_delegation.py:recover_authority() [L102-114: signing_hash = keccak256(SET_CODE_TX_MAGIC + rlp.encode((chain_id, address, nonce))); secp256k1_recover(r, s, y_parity, signing_hash)]",,
EIP7702-OBL-016,execution semantics,explicit-check,The authorization tuple s value MUST be less than or equal to secp256k1n/2 as specified in EIP-2.,[vm/eoa_delegation.py:L99-L100],vm/interpreter.py:process_message_call() -> vm/eoa_delegation.py:set_delegation() -> vm/eoa_delegation.py:recover_authority() [L99-100: if s > SECP256K1N // U256(2): raise InvalidSignatureError],,
EIP7702-OBL-017,execution semantics,state-mutation,The authority address MUST be added to accessed_addresses as defined in EIP-2929.,[vm/eoa_delegation.py:L183],vm/interpreter.py:process_message_call() -> vm/eoa_delegation.py:set_delegation() [L183: message.accessed_addresses.add(authority)],,
EIP7702-OBL-018,execution semantics,explicit-check,The code of authority MUST be empty or already delegated for the authorization to be valid.,[vm/eoa_delegation.py:L188-L189],vm/interpreter.py:process_message_call() -> vm/eoa_delegation.py:set_delegation() [L188-189: if authority_code and not is_valid_delegation(authority_code): continue],,
EIP7702-OBL-019,execution semantics,explicit-check,The nonce of authority MUST be equal to the nonce in the authorization tuple.,[vm/eoa_delegation.py:L191-L193],vm/interpreter.py:process_message_call() -> vm/eoa_delegation.py:set_delegation() [L191-193: if authority_nonce != auth.nonce: continue],,
EIP7702-OBL-020,fees,state-mutation,PER_EMPTY_ACCOUNT_COST - PER_AUTH_BASE_COST gas MUST be added to the global refund counter if authority is not empty.,[vm/eoa_delegation.py:L195-L196],"vm/interpreter.py:process_message_call() -> vm/eoa_delegation.py:set_delegation() [L195-196: if account_exists(state, authority): refund_counter += U256(PER_EMPTY_ACCOUNT_COST - PER_AUTH_BASE_COST)]",,
EIP7702-OBL-021,execution semantics,state-mutation,The code of authority MUST be set to 0xef0100 || address (the delegation indicator).,[vm/eoa_delegation.py:L201-L202],"vm/interpreter.py:process_message_call() -> vm/eoa_delegation.py:set_delegation() [L201-202: code_to_set = EOA_DELEGATION_MARKER + auth.address; set_code(state, authority, code_to_set)]",,
EIP7702-OBL-022,execution semantics,explicit-check,"If address is 0x0000000000000000000000000000000000000000, the delegation indicator MUST NOT be written; instead the account's code MUST be cleared by resetting the code hash to the empty code hash.",[vm/eoa_delegation.py:L198-L202],vm/interpreter.py:process_message_call() -> vm/eoa_delegation.py:set_delegation() [L198-202: if auth.address == NULL_ADDRESS: code_to_set = b'' else: code_to_set = EOA_DELEGATION_MARKER + auth.address],,
EIP7702-OBL-023,execution semantics,state-mutation,The nonce of authority MUST be increased by one after setting the delegation.,[vm/eoa_delegation.py:L204],"vm/interpreter.py:process_message_call() -> vm/eoa_delegation.py:set_delegation() [L204: increment_nonce(state, authority)]",,
EIP7702-OBL-024,execution semantics,control-flow,"If any authorization processing step fails, processing of that tuple MUST stop immediately and continue to the next tuple.",[vm/eoa_delegation.py:L172-L193],vm/interpreter.py:process_message_call() -> vm/eoa_delegation.py:set_delegation() [L172-193: each check uses 'continue' to skip to next tuple on failure],,
EIP7702-OBL-025,execution semantics,implicit-ordering,"When multiple tuples from the same authority are present, the code MUST be set using the address in the last valid occurrence.",[vm/eoa_delegation.py:L171-L204],vm/interpreter.py:process_message_call() -> vm/eoa_delegation.py:set_delegation() [L171-204: for loop processes authorizations in order; each valid authorization overwrites previous set_code for same authority],,
EIP7702-OBL-026,execution semantics,control-flow-ordering,"If transaction execution results in failure (exceptional condition or code reverting), the processed delegation indicators MUST NOT be rolled back.","[vm/interpreter.py:L126-L127, vm/interpreter.py:L138-L144]","vm/interpreter.py:process_message_call() [L126-127: set_delegation called before process_message; L138-144: error only affects logs/accounts_to_delete, not delegation set earlier]; delegations are set outside the transaction snapshot",,
EIP7702-OBL-027,execution semantics,delegation-resolution,"All code executing operations (CALL, CALLCODE, DELEGATECALL, STATICCALL, and transactions targeting a delegated address) MUST follow the delegation indicator to load and execute the code at the pointed address.","[vm/instructions/system.py:L382-L389, vm/instructions/system.py:L471-L477, vm/instructions/system.py:L612-L618, vm/instructions/system.py:L682-L688, vm/interpreter.py:L129-L134]","vm/instructions/system.py:call() [L382-389: access_delegation(evm, code_address)]; vm/instructions/system.py:callcode() [L471-477: access_delegation(...)]; vm/instructions/system.py:delegatecall() [L612-618: access_delegation(...)]; vm/instructions/system.py:staticcall() [L682-688: access_delegation(...)]; vm/interpreter.py:process_message_call() [L129-134: delegated_address = get_delegated_code_address(message.code)]",,
EIP7702-OBL-028,execution semantics,implicit-context,CODESIZE and CODECOPY instructions MUST operate on the executing code (the delegated code) rather than the delegation indicator.,"[vm/instructions/environment.py:L249-L269, vm/instructions/environment.py:L272-L304]","vm/instructions/environment.py:codesize() [L249-269: push(evm.stack, U256(len(evm.code))) where evm.code is the executing code]; vm/instructions/environment.py:codecopy() [L272-304: buffer_read(evm.code, ...) reads from executing code]",,
EIP7702-OBL-029,execution semantics,explicit-check,"When a precompile address is the target of a delegation, the retrieved code MUST be considered empty.","[vm/interpreter.py:L296-L298, vm/eoa_delegation.py:access_delegation]",vm/interpreter.py:process_message() [L296-298: if code_address in PRE_COMPILED_CONTRACTS and message.disable_precompiles: return evm (empty execution)]; vm/eoa_delegation.py:access_delegation() [L138-139: returns code from delegated address],,
EIP7702-OBL-030,execution semantics,explicit-check,"CALL, CALLCODE, STATICCALL, DELEGATECALL instructions targeting an account delegated to a precompile MUST execute empty code (succeed with no execution when given enough gas).",[vm/interpreter.py:L296-L302],vm/interpreter.py:process_message() [L296-302: if code_address in PRE_COMPILED_CONTRACTS and disable_precompiles: return evm immediately with no execution],,
EIP7702-OBL-031,execution semantics,single-resolution,"If a delegation indicator points to another delegation, clients MUST retrieve only the first code and stop following the delegation chain.","[vm/interpreter.py:L129-L134, vm/eoa_delegation.py:L138-L139]","vm/interpreter.py:process_message_call() [L129-134: get_delegated_code_address called once]; vm/eoa_delegation.py:access_delegation() [L138-139: only checks is_valid_delegation once, does not recurse]",,
EIP7702-OBL-032,fees,gas-calculation,The intrinsic cost MUST include: 21000 + 16 * non-zero calldata bytes + 4 * zero calldata bytes + 1900 * access list storage key count + 2400 * access list address count.,"[transactions.py:L564-L639, transactions.py:L26-L61]","fork.py:process_transaction() -> transactions.py:calculate_intrinsic_cost() [L564-639: TX_BASE_COST(21000) + data_cost + access_list_cost]; transactions.py constants [L26-61: TX_BASE_COST, STANDARD_CALLDATA_TOKEN_COST(4), TX_ACCESS_LIST_ADDRESS_COST(2400), TX_ACCESS_LIST_STORAGE_KEY_COST(1900)]",,
EIP7702-OBL-033,fees,gas-calculation,The intrinsic cost MUST add PER_EMPTY_ACCOUNT_COST (25000) * authorization list length.,"[transactions.py:L626-L628, vm/eoa_delegation.py:L25]",fork.py:process_transaction() -> transactions.py:calculate_intrinsic_cost() [L626-628: auth_cost += Uint(PER_EMPTY_ACCOUNT_COST * len(tx.authorizations))]; vm/eoa_delegation.py [L25: PER_EMPTY_ACCOUNT_COST = 25000],,
EIP7702-OBL-034,fees,gas-calculation,"The transaction sender MUST pay for all authorization tuples, regardless of validity or duplication.",[transactions.py:L626-L628],transactions.py:calculate_intrinsic_cost() [L626-628: charges auth_cost based on len(tx.authorizations) regardless of validity]; validation happens later in set_delegation(),,
EIP7702-OBL-035,fees,gas-charging,"If a code executing instruction accesses a cold account during delegation resolution, an additional COLD_ACCOUNT_READ_COST (2600 gas) MUST be charged and the account MUST be added to accessed_addresses.","[vm/eoa_delegation.py:L144-L146, vm/gas.py:L65]",vm/eoa_delegation.py:access_delegation() [L144-146: if address not in evm.accessed_addresses: access_gas_cost = GAS_COLD_ACCOUNT_ACCESS; evm.accessed_addresses.add(address)]; vm/gas.py [L65: GAS_COLD_ACCOUNT_ACCESS = 2600],,
EIP7702-OBL-036,fees,gas-charging,"If a code executing instruction accesses a warm account during delegation resolution, a WARM_STORAGE_READ_COST (100 gas) MUST be charged.","[vm/eoa_delegation.py:L142-L143, vm/gas.py:L66]",vm/eoa_delegation.py:access_delegation() [L142-143: if address in evm.accessed_addresses: access_gas_cost = GAS_WARM_ACCESS]; vm/gas.py [L66: GAS_WARM_ACCESS = 100],,
EIP7702-OBL-037,tx validation,explicit-check,EOAs whose code is a valid delegation indicator (0xef0100 || address) MUST be allowed to originate transactions.,"[fork.py:L521-L522, vm/eoa_delegation.py:is_valid_delegation]",fork.py:check_transaction() [L521-522: if sender_account.code and not is_valid_delegation(sender_account.code): raise InvalidSenderError]; vm/eoa_delegation.py:is_valid_delegation() [L30-51: checks for 0xef0100 prefix and length 23],,
EIP7702-OBL-038,tx validation,explicit-check,Accounts with any code value other than a valid delegation indicator MUST NOT be allowed to originate transactions.,[fork.py:L521-L522],fork.py:check_transaction() [L521-522: if sender_account.code and not is_valid_delegation(sender_account.code): raise InvalidSenderError('not EOA')],,
EIP7702-OBL-039,execution semantics,state-mutation,"If a transaction's destination has a delegation indicator, the target of the delegation MUST be added to accessed_addresses.",[vm/interpreter.py:L129-L134],vm/interpreter.py:process_message_call() [L129-134: if delegated_address is not None: message.accessed_addresses.add(delegated_address)],,
EIP7702-OBL-040,tx validation,encoding,"The ReceiptPayload for a set code transaction MUST be rlp([status, cumulative_transaction_gas_used, logs_bloom, logs]).","[blocks.py:L363-L384, blocks.py:L333-L359]","fork.py:process_transaction() -> fork.py:make_receipt() -> blocks.py:encode_receipt() [L363-384: SetCodeTransaction receipt is b'\x04' + rlp.encode(receipt)]; blocks.py:Receipt [L333-359: contains succeeded, cumulative_gas_used, bloom, logs]",,
