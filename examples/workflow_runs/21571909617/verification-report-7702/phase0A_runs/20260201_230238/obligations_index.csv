id,category,enforcement_type,statement,locations,code_flow,obligation_gap,code_gap
EIP7702-OBL-001,tx validation,,The TransactionType for a set code transaction MUST be SET_CODE_TX_TYPE (0x04).,,,,
EIP7702-OBL-002,tx validation,,"The TransactionPayload MUST be the RLP serialization of [chain_id, nonce, max_priority_fee_per_gas, max_fee_per_gas, gas_limit, destination, value, data, access_list, authorization_list, signature_y_parity, signature_r, signature_s].",,,,
EIP7702-OBL-003,tx validation,,A set code transaction MUST have a non-null destination.,,,,
EIP7702-OBL-004,tx validation,,The transaction signature MUST be a secp256k1 signature over keccak256(SET_CODE_TX_TYPE || TransactionPayload).,,,,
EIP7702-OBL-005,tx validation,,The transaction is invalid if the length of authorization_list is zero.,,,,
EIP7702-OBL-006,tx validation,,The authorization tuple chain_id field MUST be less than 2**256.,,,,
EIP7702-OBL-007,tx validation,,The authorization tuple nonce field MUST be less than 2**64.,,,,
EIP7702-OBL-008,tx validation,,The authorization tuple address field MUST be exactly 20 bytes.,,,,
EIP7702-OBL-009,tx validation,,The authorization tuple y_parity field MUST be less than 2**8.,,,,
EIP7702-OBL-010,tx validation,,The authorization tuple r field MUST be less than 2**256.,,,,
EIP7702-OBL-011,tx validation,,The authorization tuple s field MUST be less than 2**256.,,,,
EIP7702-OBL-012,execution semantics,,"The authorization list MUST be processed before the execution portion of the transaction begins, but after the sender's nonce is incremented.",,,,
EIP7702-OBL-013,execution semantics,,"For each authorization tuple, the chain ID MUST be verified to be 0 or the ID of the current chain.",,,,
EIP7702-OBL-014,execution semantics,,"For each authorization tuple, the nonce MUST be verified to be less than 2**64 - 1.",,,,
EIP7702-OBL-015,execution semantics,,"The authority address MUST be recovered using ecrecover(msg, y_parity, r, s) where msg = keccak(MAGIC || rlp([chain_id, address, nonce])).",,,,
EIP7702-OBL-016,execution semantics,,The authorization tuple s value MUST be less than or equal to secp256k1n/2 as specified in EIP-2.,,,,
EIP7702-OBL-017,execution semantics,,The authority address MUST be added to accessed_addresses as defined in EIP-2929.,,,,
EIP7702-OBL-018,execution semantics,,The code of authority MUST be empty or already delegated for the authorization to be valid.,,,,
EIP7702-OBL-019,execution semantics,,The nonce of authority MUST be equal to the nonce in the authorization tuple.,,,,
EIP7702-OBL-020,fees,,PER_EMPTY_ACCOUNT_COST - PER_AUTH_BASE_COST gas MUST be added to the global refund counter if authority is not empty.,,,,
EIP7702-OBL-021,execution semantics,,The code of authority MUST be set to 0xef0100 || address (the delegation indicator).,,,,
EIP7702-OBL-022,execution semantics,,"If address is 0x0000000000000000000000000000000000000000, the delegation indicator MUST NOT be written; instead the account's code MUST be cleared by resetting the code hash to the empty code hash.",,,,
EIP7702-OBL-023,execution semantics,,The nonce of authority MUST be increased by one after setting the delegation.,,,,
EIP7702-OBL-024,execution semantics,,"If any authorization processing step fails, processing of that tuple MUST stop immediately and continue to the next tuple.",,,,
EIP7702-OBL-025,execution semantics,,"When multiple tuples from the same authority are present, the code MUST be set using the address in the last valid occurrence.",,,,
EIP7702-OBL-026,execution semantics,,"If transaction execution results in failure (exceptional condition or code reverting), the processed delegation indicators MUST NOT be rolled back.",,,,
EIP7702-OBL-027,execution semantics,,"All code executing operations (CALL, CALLCODE, DELEGATECALL, STATICCALL, and transactions targeting a delegated address) MUST follow the delegation indicator to load and execute the code at the pointed address.",,,,
EIP7702-OBL-028,execution semantics,,CODESIZE and CODECOPY instructions MUST operate on the executing code (the delegated code) rather than the delegation indicator.,,,,
EIP7702-OBL-029,execution semantics,,"When a precompile address is the target of a delegation, the retrieved code MUST be considered empty.",,,,
EIP7702-OBL-030,execution semantics,,"CALL, CALLCODE, STATICCALL, DELEGATECALL instructions targeting an account delegated to a precompile MUST execute empty code (succeed with no execution when given enough gas).",,,,
EIP7702-OBL-031,execution semantics,,"If a delegation indicator points to another delegation, clients MUST retrieve only the first code and stop following the delegation chain.",,,,
EIP7702-OBL-032,fees,,The intrinsic cost MUST include: 21000 + 16 * non-zero calldata bytes + 4 * zero calldata bytes + 1900 * access list storage key count + 2400 * access list address count.,,,,
EIP7702-OBL-033,fees,,The intrinsic cost MUST add PER_EMPTY_ACCOUNT_COST (25000) * authorization list length.,,,,
EIP7702-OBL-034,fees,,"The transaction sender MUST pay for all authorization tuples, regardless of validity or duplication.",,,,
EIP7702-OBL-035,fees,,"If a code executing instruction accesses a cold account during delegation resolution, an additional COLD_ACCOUNT_READ_COST (2600 gas) MUST be charged and the account MUST be added to accessed_addresses.",,,,
EIP7702-OBL-036,fees,,"If a code executing instruction accesses a warm account during delegation resolution, a WARM_STORAGE_READ_COST (100 gas) MUST be charged.",,,,
EIP7702-OBL-037,tx validation,,EOAs whose code is a valid delegation indicator (0xef0100 || address) MUST be allowed to originate transactions.,,,,
EIP7702-OBL-038,tx validation,,Accounts with any code value other than a valid delegation indicator MUST NOT be allowed to originate transactions.,,,,
EIP7702-OBL-039,execution semantics,,"If a transaction's destination has a delegation indicator, the target of the delegation MUST be added to accessed_addresses.",,,,
EIP7702-OBL-040,tx validation,,"The ReceiptPayload for a set code transaction MUST be rlp([status, cumulative_transaction_gas_used, logs_bloom, logs]).",,,,
