id,category,enforcement_type,statement,locations,code_flow,obligation_gap,code_gap,client_locations,client_code_flow,client_obligation_gap,client_code_gap
EIP7702-OBL-001,tx validation,,The transaction is considered invalid if the length of authorization_list is zero.,"[fork.py:L510-L512, exceptions.py:L106-L109]",,,,[core/types/transaction.go:L197-L214],NOT IMPLEMENTED: EIP-7702 SetCodeTx type (0x04) not present. Transaction.decodeTyped() handles tx type dispatch but only supports up to BlobTxType (0x03).,,
EIP7702-OBL-002,tx validation,,A null destination is not valid for set code transactions.,"[fork.py:L506-L508, transactions.py:L420, exceptions.py:L32-L48]",,,,"[core/state_transition.go:L394, core/types/transaction.go:L306-L310]",NOT IMPLEMENTED: SetCodeTx not defined. Existing blob tx has similar check in StateTransition.TransitionDb() where contractCreation is determined by msg.To == nil.,,
EIP7702-OBL-003,tx validation,,The transaction is invalid if auth.chain_id >= 2**256.,[fork_types.py:L73],,,,[core/types/transaction.go:L278-L280],NOT IMPLEMENTED: Authorization tuple decoding not present. ChainId() method returns chain ID from inner tx data.,,
EIP7702-OBL-004,tx validation,,The transaction is invalid if auth.nonce >= 2**64.,[fork_types.py:L75],,,,[core/types/transaction.go:L304],NOT IMPLEMENTED: Authorization tuple nonce validation not present. Transaction.Nonce() returns uint64.,,
EIP7702-OBL-005,tx validation,,The transaction is invalid if len(auth.address) != 20.,[fork_types.py:L74],,,,[common/types.go:L180-L220],NOT IMPLEMENTED: Authorization address validation not present. common.Address is always 20 bytes by type definition.,,
EIP7702-OBL-006,tx validation,,The transaction is invalid if auth.y_parity >= 2**8.,[fork_types.py:L76],,,,[core/types/transaction.go:L41],"NOT IMPLEMENTED: Authorization y_parity validation not present. errInvalidYParity error exists but for tx signatures, not auth tuples.",,
EIP7702-OBL-007,tx validation,,The transaction is invalid if auth.r >= 2**256.,[fork_types.py:L77],,,,[core/types/transaction.go:L225-L249],NOT IMPLEMENTED: Authorization r validation not present. sanityCheckSignature validates R for transactions.,,
EIP7702-OBL-008,tx validation,,The transaction is invalid if auth.s >= 2**256.,[fork_types.py:L78],,,,[core/types/transaction.go:L225-L249],NOT IMPLEMENTED: Authorization s validation not present. sanityCheckSignature validates S for transactions.,,
EIP7702-OBL-009,execution semantics,,The authorization list must be processed before the execution portion of the transaction begins.,[vm/interpreter.py:L126-L127],,,,[core/state_transition.go:L367-L436],"NOT IMPLEMENTED: No authorization list processing. TransitionDb() currently does preCheck, intrinsic gas, then execution.",,
EIP7702-OBL-010,execution semantics,,The authorization list must be processed after the sender's nonce is incremented.,"[fork.py:L879, vm/interpreter.py:L126-L127]",,,,[core/state_transition.go:L433-L435],NOT IMPLEMENTED: No auth list processing. Nonce increment happens at L434 before evm.Call().,,
EIP7702-OBL-011,execution semantics,,"For each authorization tuple, the chain ID must be verified to be 0 or the ID of the current chain.",[vm/eoa_delegation.py:L172-L173],,,,[core/types/transaction_signing.go:L198-L199],NOT IMPLEMENTED: Authorization chain ID check not present. Transaction signer checks tx chain ID against expected.,,
EIP7702-OBL-012,execution semantics,,"For each authorization tuple, the nonce must be verified to be less than 2**64 - 1.",[vm/eoa_delegation.py:L175-L176],,,,[core/state_transition.go:L286-L289],NOT IMPLEMENTED: Authorization nonce max check not present. preCheck has ErrNonceMax for tx nonce overflow.,,
EIP7702-OBL-013,execution semantics,,"The signature value s must be less than or equal to secp256k1n/2, as specified in EIP-2.",[vm/eoa_delegation.py:L99-L100],,,,"[crypto/signature_cgo.go:L60-L70, core/vm/contracts.go:L200]",NOT IMPLEMENTED: Authorization signature s check not present. crypto.ValidateSignatureValues checks s bound. ecrecover precompile also validates.,,
EIP7702-OBL-014,execution semantics,,The authority address recovered from ecrecover must be added to accessed_addresses as defined in EIP-2929.,[vm/eoa_delegation.py:L183],,,,[core/state/statedb.go:L1240-L1260],NOT IMPLEMENTED: Authority warm address addition not present. StateDB.Prepare adds addresses to access list.,,
EIP7702-OBL-015,execution semantics,,The code of authority must be verified to be empty or already delegated.,[vm/eoa_delegation.py:L185-L189],,,,"[core/state_transition.go:L291-L295, core/types/state_account.go:L29-L30]",NOT IMPLEMENTED: Delegation indicator check not present. preCheck verifies sender has EmptyCodeHash.,,
EIP7702-OBL-016,execution semantics,,The nonce of authority must be verified to be equal to the nonce in the authorization tuple.,[vm/eoa_delegation.py:L191-L193],,,,[core/state_transition.go:L278-L289],NOT IMPLEMENTED: Authorization nonce match not present. preCheck compares tx nonce to state nonce.,,
EIP7702-OBL-017,execution semantics,,"If authority is not empty, PER_EMPTY_ACCOUNT_COST - PER_AUTH_BASE_COST gas must be added to the global refund counter.","[vm/eoa_delegation.py:L195-L196, vm/eoa_delegation.py:L25-L26]",,,,[core/state_transition.go:L470-L488],NOT IMPLEMENTED: PER_EMPTY_ACCOUNT_COST refund not present. refundGas handles existing refund counter.,,
EIP7702-OBL-018,execution semantics,,The code of authority must be set to 0xef0100 || address (the delegation indicator).,"[vm/eoa_delegation.py:L200-L202, vm/eoa_delegation.py:L22-L23]",,,,[core/state/statedb.go:L330-L340],NOT IMPLEMENTED: Delegation indicator (0xef0100) setting not present. SetCode exists but no delegation prefix logic.,,
EIP7702-OBL-019,execution semantics,,"If address is 0x0000000000000000000000000000000000000000, the delegation indicator must not be written and the account's code hash must be reset to the empty code hash.","[vm/eoa_delegation.py:L198-L202, vm/eoa_delegation.py:L27]",,,,"[core/state/statedb.go:L330-L340, core/types/state_account.go:L29-L30]",NOT IMPLEMENTED: Zero address delegation clearing not present. EmptyCodeHash constant exists.,,
EIP7702-OBL-020,execution semantics,,The nonce of authority must be increased by one after processing each authorization tuple.,[vm/eoa_delegation.py:L204],,,,[core/state/statedb.go:L320-L325],NOT IMPLEMENTED: Authority nonce increment not present. SetNonce function exists.,,
EIP7702-OBL-021,execution semantics,,"If any step in authorization processing fails, processing of that tuple must stop immediately and continue to the next tuple.",[vm/eoa_delegation.py:L172-L193],,,,[],NOT IMPLEMENTED: No authorization list processing loop exists to continue on failure.,,
EIP7702-OBL-022,execution semantics,,"When multiple tuples from the same authority are present, the code must be set using the address in the last valid occurrence.",[vm/eoa_delegation.py:L171],,,,[],NOT IMPLEMENTED: No authorization list iteration logic for duplicate authorities.,,
EIP7702-OBL-023,execution semantics,,Processed delegation indicators must not be rolled back if transaction execution results in failure.,"[vm/interpreter.py:L126-L127, state.py:L124-L143]",,,,[core/state/statedb.go:L850-L880],NOT IMPLEMENTED: Delegation persistence logic not present. RevertToSnapshot handles state rollback.,,
EIP7702-OBL-024,execution semantics,,CALL instructions targeting an address with a delegation indicator must load and execute the code at the delegated address in the context of the authority.,"[vm/instructions/system.py:L382-L389, vm/eoa_delegation.py:L117-L149]",,,,[core/vm/evm.go:L179-L257],NOT IMPLEMENTED: Delegation resolution in Call not present. EVM.Call retrieves code via StateDB.GetCode without delegation handling.,,
EIP7702-OBL-025,execution semantics,,CALLCODE instructions targeting an address with a delegation indicator must load and execute the code at the delegated address.,"[vm/instructions/system.py:L471-L477, vm/eoa_delegation.py:L117-L149]",,,,[core/vm/evm.go:L266-L307],NOT IMPLEMENTED: Delegation resolution in CallCode not present. Similar to Call.,,
EIP7702-OBL-026,execution semantics,,DELEGATECALL instructions targeting an address with a delegation indicator must load and execute the code at the delegated address.,"[vm/instructions/system.py:L612-L618, vm/eoa_delegation.py:L117-L149]",,,,[core/vm/evm.go:L309-L351],NOT IMPLEMENTED: Delegation resolution in DelegateCall not present.,,
EIP7702-OBL-027,execution semantics,,STATICCALL instructions targeting an address with a delegation indicator must load and execute the code at the delegated address.,"[vm/instructions/system.py:L682-L688, vm/eoa_delegation.py:L117-L149]",,,,[core/vm/evm.go:L353-L407],NOT IMPLEMENTED: Delegation resolution in StaticCall not present.,,
EIP7702-OBL-028,execution semantics,,Any transaction where destination points to an address with a delegation indicator must execute the delegated code.,"[vm/interpreter.py:L129-L134, vm/eoa_delegation.py:L54-L71]",,,,[core/state_transition.go:L430-L436],NOT IMPLEMENTED: Top-level tx delegation resolution not present. TransitionDb calls evm.Call without delegation check.,,
EIP7702-OBL-029,execution semantics,,"CODESIZE must operate on the executing (delegated) code, not the delegation indicator.","[vm/instructions/environment.py:L249-L269, vm/interpreter.py:L281]",,,,[core/vm/instructions.go:L369-L377],NOT IMPLEMENTED: Delegation-aware CODESIZE not present. opCodeSize uses contract.Code directly.,,
EIP7702-OBL-030,execution semantics,,"CODECOPY must operate on the executing (delegated) code, not the delegation indicator.","[vm/instructions/environment.py:L272-L304, vm/interpreter.py:L281]",,,,[core/vm/instructions.go:L379-L392],NOT IMPLEMENTED: Delegation-aware CODECOPY not present. opCodeCopy uses contract.Code.,,
EIP7702-OBL-031,execution semantics,,"When a precompile address is the target of a delegation, the retrieved code must be considered empty.","[vm/interpreter.py:L296-L298, vm/eoa_delegation.py:L147]",,,,[core/vm/evm.go:L40-L56],NOT IMPLEMENTED: Precompile delegation check not present. precompile() returns precompile contracts by address.,,
EIP7702-OBL-032,execution semantics,,"CALL, CALLCODE, STATICCALL, DELEGATECALL instructions targeting an account delegated to a precompile must execute empty code.","[vm/instructions/system.py:L382-L389, vm/instructions/system.py:L471-L477, vm/instructions/system.py:L612-L618, vm/instructions/system.py:L682-L688, vm/eoa_delegation.py:L138-L139]",,,,"[core/vm/evm.go:L226-L227, core/vm/evm.go:L289-L291, core/vm/evm.go:L333-L335, core/vm/evm.go:L383-L385]",NOT IMPLEMENTED: Precompile delegation to empty code not present. isPrecompile check exists but no delegation awareness.,,
EIP7702-OBL-033,execution semantics,,"In case a delegation indicator points to another delegation, clients must retrieve only the first code and stop following the delegation chain.",[vm/eoa_delegation.py:L137-L149],,,,[],NOT IMPLEMENTED: No delegation chain resolution logic exists.,,
EIP7702-OBL-034,fees,,The intrinsic cost of the set code transaction must include 21000 + 16 * non-zero calldata bytes + 4 * zero calldata bytes + 1900 * access list storage key count + 2400 * access list address count.,"[transactions.py:L564-L639, transactions.py:L26-L61]",,,,[core/state_transition.go:L69-L117],"NOT IMPLEMENTED: SetCodeTx intrinsic gas not present. IntrinsicGas calculates gas for data, access list but not authorization list.",,
EIP7702-OBL-035,fees,,The intrinsic cost must additionally include PER_EMPTY_ACCOUNT_COST * authorization list length.,"[transactions.py:L626-L628, vm/eoa_delegation.py:L25]",,,,"[core/state_transition.go:L112-L115, params/protocol_params.go:L94-L95]",NOT IMPLEMENTED: PER_EMPTY_ACCOUNT_COST constant not defined. TxAccessListAddressGas/StorageKeyGas exist for access list.,,
EIP7702-OBL-036,fees,,"The transaction sender must pay for all authorization tuples, regardless of validity or duplication.",[transactions.py:L627-L628],,,,[core/state_transition.go:L69-L117],NOT IMPLEMENTED: Authorization list gas charging not present in IntrinsicGas.,,
EIP7702-OBL-037,fees,,"If a code executing instruction accesses a cold account during resolution of delegated code, an additional COLD_ACCOUNT_READ_COST of 2600 gas must be charged.","[vm/eoa_delegation.py:L142-L146, vm/gas.py:L65]",,,,"[params/protocol_params.go:L66, core/vm/operations_acl.go:L27-L50]",NOT IMPLEMENTED: Delegation resolution cold access not present. ColdAccountAccessCostEIP2929 = 2600 exists.,,
EIP7702-OBL-038,fees,,"If a code executing instruction accesses a cold account during resolution of delegated code, the account must be added to accessed_addresses.",[vm/eoa_delegation.py:L145],,,,[core/state/statedb.go:L1245],NOT IMPLEMENTED: Delegation cold access list addition not present. AddAddressToAccessList function exists.,,
EIP7702-OBL-039,fees,,"If a code executing instruction accesses a warm account during resolution of delegated code, a WARM_STORAGE_READ_COST of 100 gas must be charged.","[vm/eoa_delegation.py:L142-L143, vm/gas.py:L66]",,,,[params/protocol_params.go:L68],NOT IMPLEMENTED: Delegation warm access cost not present. WarmStorageReadCostEIP2929 = 100 exists.,,
EIP7702-OBL-040,tx validation,,EOAs whose code is a valid delegation indicator (0xef0100 || address) are allowed to originate transactions.,"[fork.py:L521-L522, vm/eoa_delegation.py:L30-L51]",,,,[core/state_transition.go:L290-L295],NOT IMPLEMENTED: Delegation indicator exemption not present. preCheck rejects all accounts with code (ErrSenderNoEOA).,,
EIP7702-OBL-041,tx validation,,Accounts with any code value other than a valid delegation indicator may not originate transactions.,"[fork.py:L521-L522, vm/eoa_delegation.py:L30-L51]",,,,"[core/state_transition.go:L290-L295, core/error.go:L101-L102]",PARTIAL: ErrSenderNoEOA check exists but no delegation indicator exemption. All accounts with code are rejected.,,
EIP7702-OBL-042,execution semantics,,"If a transaction's destination has a delegation indicator, the target of the delegation must be added to accessed_addresses.",[vm/interpreter.py:L132],,,,[core/state/statedb.go:L1240-L1260],NOT IMPLEMENTED: Delegation target access list addition not present. Prepare function adds addresses.,,
EIP7702-OBL-043,block validation,,SET_CODE_TX_TYPE must be 0x04.,"[transactions.py:L493-L494, transactions.py:L514-L515]",,,,[core/types/transaction.go:L47-L52],NOT IMPLEMENTED: SetCodeTxType constant not defined. Only LegacyTxType(0x00) through BlobTxType(0x03) exist.,,
EIP7702-OBL-044,block validation,,MAGIC must be 0x05.,[vm/eoa_delegation.py:L21],,,,[],NOT IMPLEMENTED: Authorization signing magic (0x05) not defined.,,
EIP7702-OBL-045,fees,,PER_AUTH_BASE_COST must be 12500.,[vm/eoa_delegation.py:L26],,,,[params/protocol_params.go],NOT IMPLEMENTED: PER_AUTH_BASE_COST constant not defined.,,
EIP7702-OBL-046,fees,,PER_EMPTY_ACCOUNT_COST must be 25000.,[vm/eoa_delegation.py:L25],,,,[params/protocol_params.go],NOT IMPLEMENTED: PER_EMPTY_ACCOUNT_COST constant not defined.,,
EIP7702-OBL-047,tx validation,,"The transaction signature (signature_y_parity, signature_r, signature_s) must be a secp256k1 signature over keccak256(SET_CODE_TX_TYPE || TransactionPayload).","[transactions.py:L696-L701, transactions.py:L838-L863]",,,,[core/types/transaction_signing.go:L226-L245],NOT IMPLEMENTED: SetCodeTx signing hash not present. cancunSigner.Hash handles BlobTx with prefixedRlpHash.,,
EIP7702-OBL-048,execution semantics,,"The authority address must be recovered using ecrecover(keccak(MAGIC || rlp([chain_id, address, nonce])), y_parity, r, s).",[vm/eoa_delegation.py:L74-L114],,,,"[core/types/transaction_signing.go:L546-L571, crypto/signature_cgo.go:L43-L58]",NOT IMPLEMENTED: Authorization ecrecover with MAGIC not present. recoverPlain and crypto.Ecrecover exist for tx signatures.,,
