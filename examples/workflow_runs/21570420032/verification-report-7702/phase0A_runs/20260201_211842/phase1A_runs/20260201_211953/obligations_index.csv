id,category,enforcement_type,statement,locations,code_flow,obligation_gap,code_gap
EIP7702-OBL-001,tx validation,,The transaction is considered invalid if the length of authorization_list is zero.,"[fork.py:L510-L512, exceptions.py:L106-L109]",,,
EIP7702-OBL-002,tx validation,,A null destination is not valid for set code transactions.,"[fork.py:L506-L508, transactions.py:L420, exceptions.py:L32-L48]",,,
EIP7702-OBL-003,tx validation,,The transaction is invalid if auth.chain_id >= 2**256.,[fork_types.py:L73],,,
EIP7702-OBL-004,tx validation,,The transaction is invalid if auth.nonce >= 2**64.,[fork_types.py:L75],,,
EIP7702-OBL-005,tx validation,,The transaction is invalid if len(auth.address) != 20.,[fork_types.py:L74],,,
EIP7702-OBL-006,tx validation,,The transaction is invalid if auth.y_parity >= 2**8.,[fork_types.py:L76],,,
EIP7702-OBL-007,tx validation,,The transaction is invalid if auth.r >= 2**256.,[fork_types.py:L77],,,
EIP7702-OBL-008,tx validation,,The transaction is invalid if auth.s >= 2**256.,[fork_types.py:L78],,,
EIP7702-OBL-009,execution semantics,,The authorization list must be processed before the execution portion of the transaction begins.,[vm/interpreter.py:L126-L127],,,
EIP7702-OBL-010,execution semantics,,The authorization list must be processed after the sender's nonce is incremented.,"[fork.py:L879, vm/interpreter.py:L126-L127]",,,
EIP7702-OBL-011,execution semantics,,"For each authorization tuple, the chain ID must be verified to be 0 or the ID of the current chain.",[vm/eoa_delegation.py:L172-L173],,,
EIP7702-OBL-012,execution semantics,,"For each authorization tuple, the nonce must be verified to be less than 2**64 - 1.",[vm/eoa_delegation.py:L175-L176],,,
EIP7702-OBL-013,execution semantics,,"The signature value s must be less than or equal to secp256k1n/2, as specified in EIP-2.",[vm/eoa_delegation.py:L99-L100],,,
EIP7702-OBL-014,execution semantics,,The authority address recovered from ecrecover must be added to accessed_addresses as defined in EIP-2929.,[vm/eoa_delegation.py:L183],,,
EIP7702-OBL-015,execution semantics,,The code of authority must be verified to be empty or already delegated.,[vm/eoa_delegation.py:L185-L189],,,
EIP7702-OBL-016,execution semantics,,The nonce of authority must be verified to be equal to the nonce in the authorization tuple.,[vm/eoa_delegation.py:L191-L193],,,
EIP7702-OBL-017,execution semantics,,"If authority is not empty, PER_EMPTY_ACCOUNT_COST - PER_AUTH_BASE_COST gas must be added to the global refund counter.","[vm/eoa_delegation.py:L195-L196, vm/eoa_delegation.py:L25-L26]",,,
EIP7702-OBL-018,execution semantics,,The code of authority must be set to 0xef0100 || address (the delegation indicator).,"[vm/eoa_delegation.py:L200-L202, vm/eoa_delegation.py:L22-L23]",,,
EIP7702-OBL-019,execution semantics,,"If address is 0x0000000000000000000000000000000000000000, the delegation indicator must not be written and the account's code hash must be reset to the empty code hash.","[vm/eoa_delegation.py:L198-L202, vm/eoa_delegation.py:L27]",,,
EIP7702-OBL-020,execution semantics,,The nonce of authority must be increased by one after processing each authorization tuple.,[vm/eoa_delegation.py:L204],,,
EIP7702-OBL-021,execution semantics,,"If any step in authorization processing fails, processing of that tuple must stop immediately and continue to the next tuple.",[vm/eoa_delegation.py:L172-L193],,,
EIP7702-OBL-022,execution semantics,,"When multiple tuples from the same authority are present, the code must be set using the address in the last valid occurrence.",[vm/eoa_delegation.py:L171],,,
EIP7702-OBL-023,execution semantics,,Processed delegation indicators must not be rolled back if transaction execution results in failure.,"[vm/interpreter.py:L126-L127, state.py:L124-L143]",,,
EIP7702-OBL-024,execution semantics,,CALL instructions targeting an address with a delegation indicator must load and execute the code at the delegated address in the context of the authority.,"[vm/instructions/system.py:L382-L389, vm/eoa_delegation.py:L117-L149]",,,
EIP7702-OBL-025,execution semantics,,CALLCODE instructions targeting an address with a delegation indicator must load and execute the code at the delegated address.,"[vm/instructions/system.py:L471-L477, vm/eoa_delegation.py:L117-L149]",,,
EIP7702-OBL-026,execution semantics,,DELEGATECALL instructions targeting an address with a delegation indicator must load and execute the code at the delegated address.,"[vm/instructions/system.py:L612-L618, vm/eoa_delegation.py:L117-L149]",,,
EIP7702-OBL-027,execution semantics,,STATICCALL instructions targeting an address with a delegation indicator must load and execute the code at the delegated address.,"[vm/instructions/system.py:L682-L688, vm/eoa_delegation.py:L117-L149]",,,
EIP7702-OBL-028,execution semantics,,Any transaction where destination points to an address with a delegation indicator must execute the delegated code.,"[vm/interpreter.py:L129-L134, vm/eoa_delegation.py:L54-L71]",,,
EIP7702-OBL-029,execution semantics,,"CODESIZE must operate on the executing (delegated) code, not the delegation indicator.","[vm/instructions/environment.py:L249-L269, vm/interpreter.py:L281]",,,
EIP7702-OBL-030,execution semantics,,"CODECOPY must operate on the executing (delegated) code, not the delegation indicator.","[vm/instructions/environment.py:L272-L304, vm/interpreter.py:L281]",,,
EIP7702-OBL-031,execution semantics,,"When a precompile address is the target of a delegation, the retrieved code must be considered empty.","[vm/interpreter.py:L296-L298, vm/eoa_delegation.py:L147]",,,
EIP7702-OBL-032,execution semantics,,"CALL, CALLCODE, STATICCALL, DELEGATECALL instructions targeting an account delegated to a precompile must execute empty code.","[vm/instructions/system.py:L382-L389, vm/instructions/system.py:L471-L477, vm/instructions/system.py:L612-L618, vm/instructions/system.py:L682-L688, vm/eoa_delegation.py:L138-L139]",,,
EIP7702-OBL-033,execution semantics,,"In case a delegation indicator points to another delegation, clients must retrieve only the first code and stop following the delegation chain.",[vm/eoa_delegation.py:L137-L149],,,
EIP7702-OBL-034,fees,,The intrinsic cost of the set code transaction must include 21000 + 16 * non-zero calldata bytes + 4 * zero calldata bytes + 1900 * access list storage key count + 2400 * access list address count.,"[transactions.py:L564-L639, transactions.py:L26-L61]",,,
EIP7702-OBL-035,fees,,The intrinsic cost must additionally include PER_EMPTY_ACCOUNT_COST * authorization list length.,"[transactions.py:L626-L628, vm/eoa_delegation.py:L25]",,,
EIP7702-OBL-036,fees,,"The transaction sender must pay for all authorization tuples, regardless of validity or duplication.",[transactions.py:L627-L628],,,
EIP7702-OBL-037,fees,,"If a code executing instruction accesses a cold account during resolution of delegated code, an additional COLD_ACCOUNT_READ_COST of 2600 gas must be charged.","[vm/eoa_delegation.py:L142-L146, vm/gas.py:L65]",,,
EIP7702-OBL-038,fees,,"If a code executing instruction accesses a cold account during resolution of delegated code, the account must be added to accessed_addresses.",[vm/eoa_delegation.py:L145],,,
EIP7702-OBL-039,fees,,"If a code executing instruction accesses a warm account during resolution of delegated code, a WARM_STORAGE_READ_COST of 100 gas must be charged.","[vm/eoa_delegation.py:L142-L143, vm/gas.py:L66]",,,
EIP7702-OBL-040,tx validation,,EOAs whose code is a valid delegation indicator (0xef0100 || address) are allowed to originate transactions.,"[fork.py:L521-L522, vm/eoa_delegation.py:L30-L51]",,,
EIP7702-OBL-041,tx validation,,Accounts with any code value other than a valid delegation indicator may not originate transactions.,"[fork.py:L521-L522, vm/eoa_delegation.py:L30-L51]",,,
EIP7702-OBL-042,execution semantics,,"If a transaction's destination has a delegation indicator, the target of the delegation must be added to accessed_addresses.",[vm/interpreter.py:L132],,,
EIP7702-OBL-043,block validation,,SET_CODE_TX_TYPE must be 0x04.,"[transactions.py:L493-L494, transactions.py:L514-L515]",,,
EIP7702-OBL-044,block validation,,MAGIC must be 0x05.,[vm/eoa_delegation.py:L21],,,
EIP7702-OBL-045,fees,,PER_AUTH_BASE_COST must be 12500.,[vm/eoa_delegation.py:L26],,,
EIP7702-OBL-046,fees,,PER_EMPTY_ACCOUNT_COST must be 25000.,[vm/eoa_delegation.py:L25],,,
EIP7702-OBL-047,tx validation,,"The transaction signature (signature_y_parity, signature_r, signature_s) must be a secp256k1 signature over keccak256(SET_CODE_TX_TYPE || TransactionPayload).","[transactions.py:L696-L701, transactions.py:L838-L863]",,,
EIP7702-OBL-048,execution semantics,,"The authority address must be recovered using ecrecover(keccak(MAGIC || rlp([chain_id, address, nonce])), y_parity, r, s).",[vm/eoa_delegation.py:L74-L114],,,
