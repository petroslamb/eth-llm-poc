id,category,enforcement_type,statement,locations,code_flow,obligation_gap,code_gap
EIP7702-OBL-001,tx validation,,The transaction is considered invalid if the length of authorization_list is zero.,,,,
EIP7702-OBL-002,tx validation,,A null destination is not valid for set code transactions.,,,,
EIP7702-OBL-003,tx validation,,The transaction is invalid if auth.chain_id >= 2**256.,,,,
EIP7702-OBL-004,tx validation,,The transaction is invalid if auth.nonce >= 2**64.,,,,
EIP7702-OBL-005,tx validation,,The transaction is invalid if len(auth.address) != 20.,,,,
EIP7702-OBL-006,tx validation,,The transaction is invalid if auth.y_parity >= 2**8.,,,,
EIP7702-OBL-007,tx validation,,The transaction is invalid if auth.r >= 2**256.,,,,
EIP7702-OBL-008,tx validation,,The transaction is invalid if auth.s >= 2**256.,,,,
EIP7702-OBL-009,execution semantics,,The authorization list must be processed before the execution portion of the transaction begins.,,,,
EIP7702-OBL-010,execution semantics,,The authorization list must be processed after the sender's nonce is incremented.,,,,
EIP7702-OBL-011,execution semantics,,"For each authorization tuple, the chain ID must be verified to be 0 or the ID of the current chain.",,,,
EIP7702-OBL-012,execution semantics,,"For each authorization tuple, the nonce must be verified to be less than 2**64 - 1.",,,,
EIP7702-OBL-013,execution semantics,,"The signature value s must be less than or equal to secp256k1n/2, as specified in EIP-2.",,,,
EIP7702-OBL-014,execution semantics,,The authority address recovered from ecrecover must be added to accessed_addresses as defined in EIP-2929.,,,,
EIP7702-OBL-015,execution semantics,,The code of authority must be verified to be empty or already delegated.,,,,
EIP7702-OBL-016,execution semantics,,The nonce of authority must be verified to be equal to the nonce in the authorization tuple.,,,,
EIP7702-OBL-017,execution semantics,,"If authority is not empty, PER_EMPTY_ACCOUNT_COST - PER_AUTH_BASE_COST gas must be added to the global refund counter.",,,,
EIP7702-OBL-018,execution semantics,,The code of authority must be set to 0xef0100 || address (the delegation indicator).,,,,
EIP7702-OBL-019,execution semantics,,"If address is 0x0000000000000000000000000000000000000000, the delegation indicator must not be written and the account's code hash must be reset to the empty code hash.",,,,
EIP7702-OBL-020,execution semantics,,The nonce of authority must be increased by one after processing each authorization tuple.,,,,
EIP7702-OBL-021,execution semantics,,"If any step in authorization processing fails, processing of that tuple must stop immediately and continue to the next tuple.",,,,
EIP7702-OBL-022,execution semantics,,"When multiple tuples from the same authority are present, the code must be set using the address in the last valid occurrence.",,,,
EIP7702-OBL-023,execution semantics,,Processed delegation indicators must not be rolled back if transaction execution results in failure.,,,,
EIP7702-OBL-024,execution semantics,,CALL instructions targeting an address with a delegation indicator must load and execute the code at the delegated address in the context of the authority.,,,,
EIP7702-OBL-025,execution semantics,,CALLCODE instructions targeting an address with a delegation indicator must load and execute the code at the delegated address.,,,,
EIP7702-OBL-026,execution semantics,,DELEGATECALL instructions targeting an address with a delegation indicator must load and execute the code at the delegated address.,,,,
EIP7702-OBL-027,execution semantics,,STATICCALL instructions targeting an address with a delegation indicator must load and execute the code at the delegated address.,,,,
EIP7702-OBL-028,execution semantics,,Any transaction where destination points to an address with a delegation indicator must execute the delegated code.,,,,
EIP7702-OBL-029,execution semantics,,"CODESIZE must operate on the executing (delegated) code, not the delegation indicator.",,,,
EIP7702-OBL-030,execution semantics,,"CODECOPY must operate on the executing (delegated) code, not the delegation indicator.",,,,
EIP7702-OBL-031,execution semantics,,"When a precompile address is the target of a delegation, the retrieved code must be considered empty.",,,,
EIP7702-OBL-032,execution semantics,,"CALL, CALLCODE, STATICCALL, DELEGATECALL instructions targeting an account delegated to a precompile must execute empty code.",,,,
EIP7702-OBL-033,execution semantics,,"In case a delegation indicator points to another delegation, clients must retrieve only the first code and stop following the delegation chain.",,,,
EIP7702-OBL-034,fees,,The intrinsic cost of the set code transaction must include 21000 + 16 * non-zero calldata bytes + 4 * zero calldata bytes + 1900 * access list storage key count + 2400 * access list address count.,,,,
EIP7702-OBL-035,fees,,The intrinsic cost must additionally include PER_EMPTY_ACCOUNT_COST * authorization list length.,,,,
EIP7702-OBL-036,fees,,"The transaction sender must pay for all authorization tuples, regardless of validity or duplication.",,,,
EIP7702-OBL-037,fees,,"If a code executing instruction accesses a cold account during resolution of delegated code, an additional COLD_ACCOUNT_READ_COST of 2600 gas must be charged.",,,,
EIP7702-OBL-038,fees,,"If a code executing instruction accesses a cold account during resolution of delegated code, the account must be added to accessed_addresses.",,,,
EIP7702-OBL-039,fees,,"If a code executing instruction accesses a warm account during resolution of delegated code, a WARM_STORAGE_READ_COST of 100 gas must be charged.",,,,
EIP7702-OBL-040,tx validation,,EOAs whose code is a valid delegation indicator (0xef0100 || address) are allowed to originate transactions.,,,,
EIP7702-OBL-041,tx validation,,Accounts with any code value other than a valid delegation indicator may not originate transactions.,,,,
EIP7702-OBL-042,execution semantics,,"If a transaction's destination has a delegation indicator, the target of the delegation must be added to accessed_addresses.",,,,
EIP7702-OBL-043,block validation,,SET_CODE_TX_TYPE must be 0x04.,,,,
EIP7702-OBL-044,block validation,,MAGIC must be 0x05.,,,,
EIP7702-OBL-045,fees,,PER_AUTH_BASE_COST must be 12500.,,,,
EIP7702-OBL-046,fees,,PER_EMPTY_ACCOUNT_COST must be 25000.,,,,
EIP7702-OBL-047,tx validation,,"The transaction signature (signature_y_parity, signature_r, signature_s) must be a secp256k1 signature over keccak256(SET_CODE_TX_TYPE || TransactionPayload).",,,,
EIP7702-OBL-048,execution semantics,,"The authority address must be recovered using ecrecover(keccak(MAGIC || rlp([chain_id, address, nonce])), y_parity, r, s).",,,,
