id,category,enforcement_type,statement,locations,code_flow,obligation_gap,code_gap
EIP1559-OBL-001,transaction_type,tx_validation,A new EIP-2718 transaction type with type 2 is introduced at FORK_BLOCK_NUMBER,"[forks/london/__init__.py:L48, forks/london/transactions.py:L210-L282, forks/london/transactions.py:L303-L304, forks/london/transactions.py:L320-L321]",,,
EIP1559-OBL-002,transaction_format,tx_validation,"Transaction type 2 payload is rlp([chain_id, nonce, max_priority_fee_per_gas, max_fee_per_gas, gas_limit, destination, amount, data, access_list, signature_y_parity, signature_r, signature_s])","[forks/london/transactions.py:L210-L282, forks/london/transactions.py:L533-L557]",,,
EIP1559-OBL-003,transaction_signature,tx_validation,"Signature for type 2 transaction is secp256k1 signature over keccak256(0x02 || rlp([chain_id, nonce, max_priority_fee_per_gas, max_fee_per_gas, gas_limit, destination, amount, data, access_list]))","[forks/london/transactions.py:L447-L452, forks/london/transactions.py:L533-L557]",,,
EIP1559-OBL-004,transaction_intrinsic_cost,tx_validation,Intrinsic cost of type 2 transaction is 21000 + 16 * non-zero calldata bytes + 4 * zero calldata bytes + 1900 * access list storage key count + 2400 * access list address count,"[forks/london/transactions.py:L26-L55, forks/london/transactions.py:L359-L402]",,,
EIP1559-OBL-005,transaction_receipt,,"Transaction receipt payload is rlp([status, cumulative_transaction_gas_used, logs_bloom, logs])","[forks/london/blocks.py:L262-L291, forks/london/blocks.py:L294-L308, forks/london/blocks.py:L311-L326]",,,
EIP1559-OBL-006,base_fee_adjustment,block_validation,Base fee per gas moves up or down each block according to a formula based on gas used in parent block and gas target of parent block,[forks/london/fork.py:L222-L282],,,
EIP1559-OBL-007,base_fee_adjustment,block_validation,Base fee per gas increases when parent block gas used exceeds parent gas target,[forks/london/fork.py:L254-L266],,,
EIP1559-OBL-008,base_fee_adjustment,block_validation,Base fee per gas decreases when parent block gas used is below parent gas target,[forks/london/fork.py:L268-L280],,,
EIP1559-OBL-009,gas_target,,Gas target is block gas limit divided by elasticity multiplier (2x),"[forks/london/fork.py:L68-L69, forks/london/fork.py:L248]",,,
EIP1559-OBL-010,base_fee,execution_semantics,"Base fee per gas is always burned (destroyed by protocol, not given to miners)",[forks/london/fork.py:L809-L831],,,
EIP1559-OBL-011,fees,,Transactions specify max_priority_fee_per_gas (priority fee to incentivize miners),[forks/london/transactions.py:L230-L233],,,
EIP1559-OBL-012,fees,,Transactions specify max_fee_per_gas (maximum total fee covering priority fee and base fee),[forks/london/transactions.py:L235-L239],,,
EIP1559-OBL-013,fee_payment,execution_semantics,Signer pays base fee per gas of the block their transaction is included in,[forks/london/fork.py:L767-L777],,,
EIP1559-OBL-014,fee_payment,execution_semantics,Signer pays priority fee per gas as specified in transaction (if combined fees do not exceed max_fee_per_gas),"[forks/london/fork.py:L497-L501, forks/london/fork.py:L767-L777]",,,
EIP1559-OBL-015,priority_fee,execution_semantics,"Priority fee per gas is capped at min(max_priority_fee_per_gas, max_fee_per_gas - base_fee_per_gas)",[forks/london/fork.py:L497-L500],,,
EIP1559-OBL-016,effective_gas_price,execution_semantics,Effective gas price returned by GASPRICE opcode is priority_fee_per_gas + base_fee_per_gas,[forks/london/vm/instructions/environment.py:L304-L324],,,
EIP1559-OBL-017,miner_reward,execution_semantics,Miner receives only the priority fee (not the base fee which is burned),[forks/london/fork.py:L810-L822],,,
EIP1559-OBL-018,block_validation,block_validation,Block gas used must not exceed block gas limit,[forks/london/fork.py:L320-L321],,,
EIP1559-OBL-019,block_validation,block_validation,Block gas limit change from parent is limited to parent_gas_limit / 1024 (can increase or decrease),[forks/london/fork.py:L855-L892],,,
EIP1559-OBL-020,block_validation,block_validation,Block gas limit must be at least 5000,"[forks/london/fork.py:L71, forks/london/fork.py:L855-L892]",,,
EIP1559-OBL-021,base_fee_calculation,block_validation,"At fork block (FORK_BLOCK_NUMBER), initial base fee per gas is 1000000000","[forks/london/fork.py:L73, forks/london/fork.py:L325-L337]",,,
EIP1559-OBL-022,base_fee_calculation,block_validation,"At fork block, gas target is parent gas limit (no elasticity multiplier division)",[forks/london/fork.py:L222-L282],,,
EIP1559-OBL-023,base_fee_calculation,block_validation,"When parent gas used equals parent gas target, base fee remains unchanged",[forks/london/fork.py:L254-L280],,,
EIP1559-OBL-024,base_fee_calculation,block_validation,"When parent gas used exceeds parent gas target, base fee delta is max(parent_base_fee * gas_used_delta // parent_gas_target // 8, 1)",[forks/london/fork.py:L254-L266],,,
EIP1559-OBL-025,base_fee_calculation,block_validation,"When parent gas used is below parent gas target, base fee delta is parent_base_fee * gas_used_delta // parent_gas_target // 8",[forks/london/fork.py:L268-L280],,,
EIP1559-OBL-026,tx_validation,tx_validation,Signer must have enough balance to cover transaction amount,[forks/london/fork.py:L509-L514],,,
EIP1559-OBL-027,tx_validation,tx_validation,Signer must have enough balance to cover gas_limit * max_fee_per_gas,[forks/london/fork.py:L439-L518],,,
EIP1559-OBL-028,tx_validation,tx_validation,Signer must have enough balance to cover gas_limit * effective_gas_price after amount deduction,[forks/london/fork.py:L509-L514],,,
EIP1559-OBL-029,tx_validation,tx_validation,max_fee_per_gas must be >= base_fee_per_gas of the block,[forks/london/fork.py:L487-L495],,,
EIP1559-OBL-030,tx_validation,tx_validation,max_fee_per_gas must be < 2^256 (prevent impossibly large numbers),[forks/london/fork.py:L487-L495],,,
EIP1559-OBL-031,tx_validation,tx_validation,max_priority_fee_per_gas must be < 2^256 (prevent impossibly large numbers),[forks/london/fork.py:L487-L495],,,
EIP1559-OBL-032,tx_validation,tx_validation,max_fee_per_gas must be >= max_priority_fee_per_gas,[forks/london/fork.py:L487-L495],,,
EIP1559-OBL-033,block_validation,block_validation,Block cumulative gas used must equal sum of gas used in all transactions,[forks/london/fork.py:L202-L205],,,
EIP1559-OBL-034,gas_refund,execution_semantics,Signer is refunded for unused gas at effective_gas_price,"[forks/london/fork.py:L801-L807, forks/london/fork.py:L814-L817]",,,
EIP1559-OBL-035,opcode_compatibility,execution_semantics,GASPRICE opcode (0x3a) must return effective_gas_price,[forks/london/vm/instructions/environment.py:L304-L324],,,
