id,category,enforcement_type,statement,locations,code_flow,obligation_gap,code_gap
EIP1559-OBL-001,tx validation,consensus,The GASPRICE opcode (0x3a) MUST return the effective_gas_price.,"[vm/instructions/environment.py:304-324, fork.py:789]",,,
EIP1559-OBL-002,block validation,consensus,Block gas_used MUST be less than or equal to block gas_limit.,"[fork.py:320-321, fork.py:202-205]",,,
EIP1559-OBL-003,block validation,consensus,Block gas_limit MUST be less than parent_gas_limit + parent_gas_limit // 1024.,[fork.py:884-886],,,
EIP1559-OBL-004,block validation,consensus,Block gas_limit MUST be greater than parent_gas_limit - parent_gas_limit // 1024.,[fork.py:887-888],,,
EIP1559-OBL-005,block validation,consensus,Block gas_limit MUST be at least 5000.,"[fork.py:889-890, fork.py:71]",,,
EIP1559-OBL-006,base fee adjustment,consensus,"On the fork block (INITIAL_FORK_BLOCK_NUMBER), the base_fee_per_gas MUST be set to INITIAL_BASE_FEE (1000000000).","[fork.py:325-327, fork.py:73]",,,
EIP1559-OBL-007,base fee adjustment,consensus,"If parent_gas_used equals parent_gas_target, then base_fee_per_gas MUST remain equal to parent_base_fee_per_gas.",[fork.py:252-253],,,
EIP1559-OBL-008,base fee adjustment,consensus,"If parent_gas_used is greater than parent_gas_target, then base_fee_per_gas MUST increase by at least 1 and by max(parent_base_fee_per_gas * gas_used_delta // parent_gas_target // BASE_FEE_MAX_CHANGE_DENOMINATOR, 1).",[fork.py:254-267],,,
EIP1559-OBL-009,base fee adjustment,consensus,"If parent_gas_used is less than parent_gas_target, then base_fee_per_gas MUST decrease by parent_base_fee_per_gas * gas_used_delta // parent_gas_target // BASE_FEE_MAX_CHANGE_DENOMINATOR.",[fork.py:268-280],,,
EIP1559-OBL-010,block validation,consensus,The block's base_fee_per_gas MUST equal the expected_base_fee_per_gas calculated from the parent block.,[fork.py:329-337],,,
EIP1559-OBL-011,tx validation,consensus,Transaction signature and chain ID MUST be validated before normalizing the transaction.,"[fork.py:484, transactions.py:405-454]",,,
EIP1559-OBL-012,tx validation,consensus,Signer balance after deducting transaction amount MUST be greater than or equal to 0.,[fork.py:513-514],,,
EIP1559-OBL-013,tx validation,consensus,Signer balance MUST be at least transaction.gas_limit * transaction.max_fee_per_gas.,"[fork.py:502-507, fork.py:513-514]",,,
EIP1559-OBL-014,tx validation,consensus,Transaction max_fee_per_gas MUST be greater than or equal to block base_fee_per_gas.,[fork.py:492-495],,,
EIP1559-OBL-015,tx validation,consensus,Transaction max_fee_per_gas MUST be less than 2**256.,[transactions.py:230-239],,,
EIP1559-OBL-016,tx validation,consensus,Transaction max_priority_fee_per_gas MUST be less than 2**256.,[transactions.py:230-239],,,
EIP1559-OBL-017,tx validation,consensus,Transaction max_fee_per_gas MUST be greater than or equal to transaction max_priority_fee_per_gas.,[fork.py:488-491],,,
EIP1559-OBL-018,execution semantics,consensus,The priority_fee_per_gas MUST be the minimum of max_priority_fee_per_gas and (max_fee_per_gas - base_fee_per_gas).,[fork.py:497-500],,,
EIP1559-OBL-019,execution semantics,consensus,The effective_gas_price MUST equal priority_fee_per_gas + base_fee_per_gas.,"[fork.py:501, fork.py:789]",,,
EIP1559-OBL-020,execution semantics,consensus,Signer balance MUST be debited by transaction.gas_limit * effective_gas_price before transaction execution.,"[fork.py:767, fork.py:772-777]",,,
EIP1559-OBL-021,tx validation,consensus,Signer balance after deducting gas costs MUST be greater than or equal to 0.,[fork.py:513-514],,,
EIP1559-OBL-022,execution semantics,consensus,"After transaction execution, signer MUST be refunded (gas_limit - gas_used) * effective_gas_price.",[fork.py:801-817],,,
EIP1559-OBL-023,fees,consensus,"The miner (block author) MUST receive only the priority fee (gas_used * priority_fee_per_gas), not the base fee.","[fork.py:810-811, fork.py:819-828]",,,
EIP1559-OBL-024,fees,consensus,The base fee MUST be burned (not given to any party).,"[fork.py:810-811, fork.py:819-828]",,,
EIP1559-OBL-025,block validation,consensus,The cumulative_transaction_gas_used MUST equal the block's gas_used.,"[fork.py:837, fork.py:202-205]",,,
EIP1559-OBL-026,tx validation,consensus,"Type 2 transactions MUST have TransactionPayload formatted as rlp([chain_id, nonce, max_priority_fee_per_gas, max_fee_per_gas, gas_limit, destination, amount, data, access_list, signature_y_parity, signature_r, signature_s]).","[transactions.py:208-283, transactions.py:303-304]",,,
EIP1559-OBL-027,tx validation,consensus,"Type 2 transaction signature MUST be a secp256k1 signature over keccak256(0x02 || rlp([chain_id, nonce, max_priority_fee_per_gas, max_fee_per_gas, gas_limit, destination, amount, data, access_list])).","[transactions.py:447-452, transactions.py:533-557]",,,
EIP1559-OBL-028,tx validation,consensus,"Type 2 transaction ReceiptPayload MUST be formatted as rlp([status, cumulative_transaction_gas_used, logs_bloom, logs]).","[blocks.py:262-292, blocks.py:294-308]",,,
EIP1559-OBL-029,tx validation,consensus,The intrinsic cost of Type 2 transactions MUST be 21000 + 16 * non-zero calldata bytes + 4 * zero calldata bytes + 1900 * access list storage key count + 2400 * access list address count.,"[transactions.py:359-402, transactions.py:26-55]",,,
EIP1559-OBL-030,block validation,consensus,"On the fork block, parent_gas_target MUST be set to parent.gas_limit (not divided by ELASTICITY_MULTIPLIER).",[fork.py:248],,,
EIP1559-OBL-031,block validation,consensus,"On the fork block, parent_gas_limit MUST be multiplied by ELASTICITY_MULTIPLIER when validating the current block's gas_limit.",[fork.py:249-250],,,
EIP1559-OBL-032,block validation,consensus,"After the fork block, parent_gas_target MUST be calculated as parent.gas_limit // ELASTICITY_MULTIPLIER.","[fork.py:248, fork.py:69]",,,
EIP1559-OBL-033,execution semantics,,Transactions with the same priority fee SHOULD be sorted by time received to protect against spam attacks.,[],,,
EIP1559-OBL-034,execution semantics,,Miners SHOULD prefer transactions with higher priority fees from a selfish mining perspective.,[],,,
